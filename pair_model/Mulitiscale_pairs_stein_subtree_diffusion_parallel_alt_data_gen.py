import time
import random
import numpy as np
import pandas as pd
import pylab as plt
import matplotlib.pyplot as ptr
import enum
import re
from scipy.integrate import odeint
from scipy.stats import pearsonr, spearmanr, poisson, ks_2samp, uniform, differential_entropy
from mesa import Agent, Model
from mesa.time import RandomActivation
from mesa.space import MultiGrid
from mesa.datacollection import DataCollector
import seaborn as sns

import networkx as nx

from multiprocessing import Pool, current_process

steps_per_day = 30
viral_load_max = 50000

p_trans_div = viral_load_max * steps_per_day

class InfectionMultiscaleModel(Model):
    """A model for infection spread."""

    def __init__(self, N=10, steps_per_day = 2,
                 v_threshold=300000, G='constant', F='linear',
                 con_init=5, lin_init=1, log_init=1,
                 sig_init=1, delay=0, output_tree=None):

        self.num_agents = N
        self.steps_per_day = steps_per_day
        self.con_init = con_init
        self.lin_init = lin_init
        self.log_init = log_init
        self.sig_init = sig_init
        self.delay = delay
        self.schedule = RandomActivation(self)
        self.running = True
        self.dead_agents = []
        self.G = G
        self.F = F
        self.r0 = 0
        self.ptrans = 1.0 / steps_per_day
        self.viral_load_max = 25000
        self.inoc_max = 50000
        self.inoc_max_sig = np.power(self.inoc_max/2,self.sig_init)
        self.infected = 0
        self.removed = 0
        self.viral_load_tree = dict()

        self.sig_infector_multiplier = self.lin_init * self.inoc_max
        self.sig_ptrans_multiplier = self.inoc_max / p_trans_div

        self.con_ptrans_multiplier = self.sig_ptrans_multiplier / 2

        if G == 'constant':
            # self.v_threshold = 1 / self.lin_init
            self.v_threshold = 5000
        elif G == 'random':
            # self.v_threshold = 1 / self.lin_init
            self.v_threshold = 5000
        elif G == 'linear':
            # self.v_threshold = 1 / self.lin_init
            self.v_threshold = 5000
        elif G == 'log':
            self.v_threshold = np.exp(1 / (self.log_init * self.inoc_max))
        elif G == 'sigmoid':
            beta = self.lin_init * self.inoc_max
            self.v_threshold = np.power(self.inoc_max_sig/(beta * (1 - (1/beta))),1/self.sig_init) - self.delay
            # self.v_threshold = 5000

        # print(self.lin_init,self.sig_init,self.v_threshold)

        # Create agents
        for i in range(self.num_agents):
            a = MSMyAgent(i, self)
            self.schedule.add(a)
            if i == 1:
                a.state = MSState.INFECTED
                a.infection_course = a.infect_stein_init('constant',a.unique_id,1,1)

        self.datacollector = DataCollector(
            model_reporters={"r0" : "r0",
                            "viral_load_tree" : "viral_load_tree"},
            agent_reporters={"State": "state"})

    def step(self):
        self.datacollector.collect(self)
        self.viral_load_tree = dict()
        self.schedule.step()

        

class MSState(enum.IntEnum):
    SUSCEPTIBLE = 0
    INFECTED = 1
    REMOVED = 2

def differential_stein(n_stein, t, r,kI,kN,kP,aI,aN,aP,bI,dN,c,kV,KI,tN,tP):
    dV_dt = r*n_stein[0] - n_stein[0]*(((r*n_stein[0])/kV) + kI*n_stein[1] + kN*n_stein[2] + kP*n_stein[3])
    dI_dt = aI*n_stein[0] + bI*(1-(n_stein[1]/KI))
    dN_dt = aN*n_stein[0]*np.heaviside(t-tN,1)-dN*n_stein[2]
    dP_dt = aP*n_stein[0]*n_stein[3] + c*n_stein[2]*(t-tP)
    return dV_dt, dI_dt, dN_dt, dP_dt
    
class MSMyAgent(Agent):
    """ An agent in an epidemic model."""
    def __init__(self, unique_id, model):
        super().__init__(unique_id, model)      
        self.state = MSState.SUSCEPTIBLE  
        self.infection_time = 0
        self.infection_course = []
        self.init_v = 0
    
    def infect_stein(self, G, donor_id, donor, donor_init_v):
        t = np.linspace(0, 24, num=24 * self.model.steps_per_day)
        y0 = ()
        r = 5.5
        kI = 0.05
        kN = 0.5
        kP = 2
        aI = 0.000000001
        aN = 0.00000001
        aP = 0.000005
        bI = 2
        dN = 0.05
        c = 0.01
        kV = 100000000000
        KI = 100
        tN = 2.5
        tP = 3
        n0 = 0
        p0 = 2
        
        if G == 'constant':
            init_v = self.model.con_init
        elif G == 'random':
            init_v = self.random.randint(1,450)
        elif G == 'bottleneck':
            init_v = np.minimum(1, donor * 0.000001)
        elif G == 'linear':
            # init_v = self.model.lin_init * donor
            foo = self.model.lin_init * donor
            init_v = np.mean(poisson.rvs(foo, size=100))
        elif G == 'log':
            init_v = self.model.log_init * np.log(donor)
        elif G == 'sigmoid':
            # init_v = self.model.lin_init * self.model.inoc_max * np.power(donor + self.model.delay,self.model.sig_init) / (np.power(donor + self.model.delay,self.model.sig_init) + self.model.inoc_max_sig)
            foo = self.model.sig_infector_multiplier * np.power(donor + self.model.delay,self.model.sig_init) / (np.power(donor + self.model.delay,self.model.sig_init) + self.model.inoc_max_sig)
            init_v = np.mean(poisson.rvs(foo, size=100))

        self.model.infected += 1
        self.model.viral_load_tree[(donor_id,self.unique_id)] = (donor_init_v,init_v,donor,self.infection_time)

        self.init_v = init_v
            
        y0 = (init_v, 0, n0, p0)
        
        solution = odeint(differential_stein, y0, t, args=(r,kI,kN,kP,aI,aN,aP,bI,dN,c,kV,KI,tN,tP))
        solution = [[row[i] for row in solution] for i in range(4)]

        return solution

    def infect_stein_init(self, G, donor_id, donor, donor_init_v):
        t = np.linspace(0, 24, num=24 * self.model.steps_per_day)
        y0 = ()
        r = 5.5
        kI = 0.05
        kN = 0.5
        kP = 2
        aI = 0.000000001
        aN = 0.00000001
        aP = 0.000005
        bI = 2
        dN = 0.05
        c = 0.01
        kV = 100000000000
        KI = 100
        tN = 2.5
        tP = 3
        n0 = 0
        p0 = 2
        
        if G == 'constant':
            init_v = self.model.con_init
        elif G == 'random':
            init_v = self.random.randint(1,3000000)
        elif G == 'bottleneck':
            init_v = np.minimum(1, donor * 0.000001)
        elif G == 'linear':
            init_v = self.model.lin_init * donor
        elif G == 'log':
            init_v = self.model.log_init * np.log(donor)
        elif G == 'sigmoid':
            init_v = self.model.lin_init * self.model.inoc_max * np.power(donor + self.model.delay,self.model.sig_init) / (np.power(donor + self.model.delay,self.model.sig_init) + self.model.inoc_max_sig)

        self.model.infected += 1
        # self.model.viral_load_tree[(donor_id,self.unique_id)] = (donor_init_v,init_v,donor)

        self.init_v = init_v
            
        y0 = (init_v, 0, n0, p0)
        
        solution = odeint(differential_stein, y0, t, args=(r,kI,kN,kP,aI,aN,aP,bI,dN,c,kV,KI,tN,tP))
        solution = [[row[i] for row in solution] for i in range(4)]

        return solution

    def status(self):
        """Check infection status"""

        if self.state == MSState.INFECTED: 
            t = self.model.schedule.time-self.infection_time
            if self.infection_course[0][t] < 1:
                self.state = MSState.REMOVED
                self.model.infected -= 1
                self.model.removed += 1


    def contact(self):
        """Find close contacts and infect"""
        
        if self.state is MSState.INFECTED:
            cellmates = self.random.sample(self.model.schedule.agents,k=1)
            t = self.model.schedule.time-self.infection_time
            if t>0:
                var_ptrans = self.get_ptrans(self.infection_course[0][t], self.model.F)
                for other in cellmates:
                    # if other.state is MSState.SUSCEPTIBLE and self.infection_course[0][t] > self.model.v_threshold and self.random.random() < var_ptrans:                 
                    if other.state is MSState.SUSCEPTIBLE and self.random.random() < var_ptrans:
                        other.state = MSState.INFECTED
                        other.infection_time = self.model.schedule.time
                        other.infection_course = other.infect_stein(self.model.G,self.unique_id,self.infection_course[0][t],self.init_v)
                        if self.unique_id == 1:
                            self.model.r0 += 1
                        # print(self.init_v,var_ptrans,self.infection_course[0][t],other.init_v)
                    
    def step(self):
        self.status()
        self.contact()

    def get_ptrans(self,V,F):
        if V < self.model.v_threshold:
            return 0
        if F == 'linear':
            return V / p_trans_div
        if F == 'sigmoid':
            return self.model.sig_ptrans_multiplier * np.power(V,self.model.sig_init) / (np.power(V,self.model.sig_init) + np.power(self.model.inoc_max/2,self.model.sig_init))
        if F == 'random':
            return self.random.random() * self.model.sig_ptrans_multiplier
        if F == 'constant':
            return self.model.con_ptrans_multiplier

def get_column_data(model):
    """pivot the model dataframe to get states count at each step"""
    agent_state = model.datacollector.get_agent_vars_dataframe()
    model_state = model.datacollector.get_model_vars_dataframe()

    X = pd.pivot_table(agent_state.reset_index(),index='Step',columns='State',aggfunc=np.size,fill_value=0)    
    X['r0'] = model_state['r0']
    X['viral_load_tree'] = model_state['viral_load_tree']

    labels = ['Susceptible','Infected','Removed','R0','Viral Load Tree']
    X.columns = labels[:len(X.columns)]
    X['Incidence'] = X['Susceptible'].diff() * -1
    X['Recovery'] = X['Removed'].diff()


    for j in range(X.shape[0],steps):
        X.loc[j] = 0
        X['Viral Load Tree'].loc[j] = []
    X['Days'] = X.index
    X['Days'] = X['Days'].div(steps_per_day)


    X['Incidence Sum'] = X['Incidence']
    X['Incidence Days'] = 0

    for i in range(0,days):
        X['Incidence Sum'].loc[i] = X['Incidence'][i*steps_per_day:(i+1)*steps_per_day].sum()
        X['Incidence Days'].loc[i] = i
    return X

def get_peak_viral_load(init):
    t = np.linspace(0, 12, num=12 * steps_per_day)
    y0 = ()
    r = 5.5
    kI = 0.05
    kN = 0.5
    kP = 2
    aI = 0.000000001
    aN = 0.00000001
    aP = 0.000005
    bI = 2
    dN = 0.05
    c = 0.01
    kV = 100000000000
    KI = 100
    tN = 2.5
    tP = 3
    n0 = 0
    p0 = 2

    y0 = (init, 0, n0, p0)
        
    solution = odeint(differential_stein, y0, t, args=(r,kI,kN,kP,aI,aN,aP,bI,dN,c,kV,KI,tN,tP))
    solution = [[row[i] for row in solution] for i in range(4)]

    return max(solution[0])


def get_all_lengths(G,root):

    paths = []

    for node in G:
        if G.out_degree(node)==0:
            paths.append(nx.shortest_path_length(G, source=root, target=node))
    
    return paths

def get_avg_length(G,root):
    paths = []

    for node in G:
        if G.out_degree(node)==0:
            paths.append(nx.shortest_path_length(G, source=root, target=node))

    return np.mean(paths)



days = 300
steps = steps_per_day * days
pop = 1000

ptrans = ['sigmoid','linear','random','constant']
# ptrans = ['sigmoid','linear','random'] 
# dv_rvs = ['sigmoid','linear','random']
dv_rvs = ['linear']

work = [[c,a] for a in ptrans for c in dv_rvs]

work.append(('sigmoid','constant'))

print(work)

ptr.close("all")

data_whole = pd.DataFrame()

# sig_sig = [21.95, 445.06, 423.3, 242.42, 333.05, 9.25, 273.99, 462.91, 387.95, 166.09, 473.02, 145.35, 388.79, 405.45, 445.74, 468.24, 468.98, 437.21, 251.74, 280.08, 453.87, 296.85, 470.34, 463.05, 460.68, 450.29, 382.23, 294.97, 465.76, 469.97, 186.41, 464.76, 470.48, 303.5, 121.07, 385.71, 458.2, 35.63, 202.51, 446.06, 455.86, 473.04, 385.39, 258.18, 456.71, 70.64, 457.08, 194.55, 359.54, 388.93, 216.82, 467.27, 464.08, 422.74, 330.78, 464.6, 446.05, 450.22, 439.89, 259.55, 449.65, 467.81, 257.94, 363.86, 353.84, 438.11, 459.06, 460.98, 373.65, 407.65, 463.56, 470.02, 396.05, 463.69, 389.46, 36.03, 445.54, 466.95, 465.96, 447.49, 468.18, 404.95, 444.86, 366.44, 451.18, 291.16, 454.61, 235.47, 231.77, 254.33, 460.58, 453.18, 465.19, 456.6, 394.83, 470.9, 473.33, 353.26, 445.66, 277.16, 450.29, 432.3, 360.09, 322.69, 430.05, 438.71, 354.52, 417.46, 470.0, 360.93, 179.44, 116.88, 472.51, 316.99, 439.59, 378.56, 316.21, 299.68, 336.73, 367.55, 438.63, 415.36, 353.52, 293.04, 440.01, 465.75, 473.0, 429.06, 208.32, 413.62, 445.01, 425.33, 459.26, 332.22, 387.16, 402.03, 459.76, 465.84, 408.91, 470.88, 437.0, 465.39, 396.46, 160.93, 449.67, 322.42, 381.61, 455.45, 424.93, 464.54, 361.41, 410.97, 430.67, 469.77, 340.26, 449.55, 444.95, 233.11, 318.38, 389.67, 121.34, 471.52, 462.21, 235.83, 467.45, 135.94, 204.7, 462.27, 435.82, 470.31, 187.47, 105.71, 472.87, 459.01, 460.61, 17.5, 403.8, 350.51, 299.17, 374.73, 74.97, 427.45, 456.42, 290.29, 293.66, 299.88, 443.27, 340.98, 445.74, 456.45, 190.77, 442.69, 371.26, 460.85, 466.53, 456.06, 361.51, 289.83, 458.25, 450.33, 396.63, 470.71, 458.57, 442.18, 463.41, 225.75, 32.56, 115.48, 366.78, 451.54, 449.9, 432.17, 462.97, 192.21, 163.52, 442.47, 467.45, 459.9, 435.76, 468.43, 452.91, 364.63, 436.07, 425.12,
#             384.43, 164.17, 470.92, 251.74, 462.4, 470.51, 455.58, 459.86, 455.79, 439.68, 218.05, 417.46, 389.61, 276.26, 406.34, 324.87, 193.63, 108.76, 8.01, 472.79, 455.83, 394.17, 451.98, 470.11, 423.03, 406.47, 440.3, 457.85, 458.68, 452.4, 400.65, 189.55, 400.16, 464.93, 320.11, 239.87, 435.97, 434.06, 443.42, 340.44, 463.7, 473.15, 467.18, 467.91, 472.17, 452.17, 474.06, 462.88, 286.31, 278.14, 424.07, 472.69, 175.43, 374.46, 473.16, 465.77, 369.64, 448.79, 68.69, 370.59, 468.9, 470.54, 372.04, 429.02, 368.61, 426.25, 389.24, 305.18, 344.46, 363.57, 473.58, 471.96, 395.66, 465.36, 463.06, 147.11, 473.61, 448.56, 369.41, 469.0, 456.91, 416.57, 441.02, 457.73, 241.59, 465.52, 431.29, 230.36, 391.12, 379.6, 464.5, 473.12, 469.67, 357.92, 378.85, 420.24, 243.27, 457.13, 445.14, 458.4, 466.29, 363.81, 388.36, 473.36, 451.29, 465.28, 439.68, 447.35, 445.14, 468.96, 263.61, 377.16, 402.54, 119.66, 471.68, 423.69, 472.29, 340.97, 412.59, 433.9, 473.82, 356.45, 292.96, 38.57, 468.63, 469.38, 424.95, 467.03, 454.07, 471.65, 468.66, 311.93, 292.95, 461.66, 361.83, 293.49, 265.98, 470.62, 468.98, 385.79, 436.37, 182.54, 264.2, 466.98, 360.85, 436.02, 467.53, 295.7, 473.26, 459.34, 293.31, 264.22, 390.95, 469.74, 391.3, 256.47, 466.79, 408.06, 115.7, 458.91, 471.35, 457.56, 334.93, 465.9,
#             231.51, 424.52, 352.99, 469.84, 464.01, 471.91, 427.99, 95.55, 277.08, 465.13, 402.86, 250.98, 452.49, 457.87, 427.05, 443.69, 466.37, 382.81, 119.56, 469.29, 460.5, 92.18, 466.87, 470.37, 432.45, 455.96, 224.07, 142.75, 263.84, 174.47, 468.27, 322.19, 455.95, 349.44, 278.02, 448.01, 453.83, 440.98, 471.09, 443.72, 419.48, 474.84, 110.41, 230.46, 449.95, 454.07, 337.11, 474.94, 442.51, 189.98, 381.48, 100.87, 64.9, 13.07, 400.09, 426.99, 464.86, 456.41, 463.38, 457.21, 242.24, 136.34, 400.15, 457.69, 474.53, 440.99, 443.57, 451.46, 381.44, 365.63, 424.79, 365.82, 201.03, 412.45, 418.09, 213.58, 466.39, 365.02, 467.1, 421.88, 464.67, 470.48, 466.17, 472.34, 454.61, 427.52, 267.24, 303.87, 466.86, 421.01, 117.07, 435.14, 466.94, 275.96, 420.08, 462.56, 451.82, 474.18, 461.89, 472.66, 388.86, 447.49, 442.04, 462.86, 470.15, 475.05, 367.83, 469.86, 428.87, 96.76, 460.98, 448.99, 55.7, 463.31, 364.56, 468.9, 456.98, 281.55, 438.83, 418.36, 420.16, 463.48, 446.64, 323.11, 432.23, 389.09, 471.77, 324.89, 319.14, 391.93, 468.82, 411.14, 460.69, 469.96, 445.37, 442.26, 461.29, 469.69, 317.61, 295.04, 205.51, 343.47, 469.48, 425.1, 375.63, 7.49, 395.46, 466.59, 369.16, 465.01, 455.75, 458.91, 256.62, 443.14, 460.04, 454.93, 273.56, 409.77, 442.8, 390.48, 202.28, 398.5, 459.84, 178.1, 179.47, 450.42, 301.28, 434.01, 417.91, 364.99, 441.22, 459.19, 419.48, 411.79, 421.98, 386.39, 330.79, 472.32, 279.36, 419.69, 394.09, 264.83, 159.47, 205.56, 279.47, 425.88, 244.18, 469.52, 376.64, 69.36, 388.68, 466.97, 465.61, 375.85, 445.63, 268.51, 445.38, 443.47, 422.22, 468.34, 418.83, 421.63, 345.81, 470.12, 296.47, 410.5, 367.88, 458.57, 12.42, 279.52, 7.79, 238.03, 232.8, 162.6, 316.33, 453.0, 467.84, 416.03, 455.77, 396.99, 451.16, 450.55, 299.62, 466.07, 224.44, 342.36, 368.57, 386.56, 201.8, 466.62, 468.0, 465.45, 468.88, 451.18, 468.37, 454.08, 448.44, 147.43, 399.23, 37.3,
#             459.27, 353.38, 454.72, 24.85, 455.92, 453.54, 435.67, 425.06, 333.87, 105.9, 450.51, 449.95, 277.63, 473.5, 434.69, 431.15, 473.65, 439.86, 463.7, 375.51, 462.99, 373.22, 429.93, 426.69, 314.06, 6.69, 283.97, 472.78, 208.04, 357.56, 177.86, 468.85, 469.09, 230.56, 470.7, 374.54, 457.04, 346.98, 471.65, 345.64, 467.33, 474.53, 118.44, 467.29, 427.36, 455.55, 288.66, 183.99, 338.8, 244.85, 238.08, 466.93, 466.79, 439.68, 258.26, 471.24, 430.84, 403.15, 462.87, 338.5, 443.61, 412.11, 343.21, 300.87, 384.26, 468.32, 429.02, 444.43, 460.38, 448.17, 441.07, 464.32, 447.49, 329.17, 469.03, 150.39, 450.45, 469.72, 473.61, 222.28, 241.12, 446.51, 289.94, 448.64, 468.08, 448.19, 232.68, 328.0, 406.18, 465.79, 471.28, 426.38, 459.51, 457.23, 362.36, 458.19, 177.24, 388.24, 440.77, 470.07, 371.49, 455.22, 255.43, 388.13, 394.86, 447.12, 382.29, 300.01, 19.49, 457.6, 415.59, 218.36, 464.94, 444.83, 438.22, 457.51, 402.31, 462.92, 469.4, 470.76, 461.9, 435.77, 228.42, 429.17, 436.1, 440.83, 321.56, 456.95, 457.87, 444.62, 236.3, 289.09, 450.54, 456.87, 327.26, 409.66, 464.52, 194.91, 447.45, 100.47, 204.57, 474.3, 460.52, 383.38, 465.34, 466.62, 435.16, 398.32, 461.08, 337.41, 458.27, 438.35, 426.65, 220.03, 357.76, 456.97, 447.48, 411.54, 117.39, 297.16, 320.91, 448.24, 127.09, 380.68, 444.7, 474.81, 447.61, 224.84, 465.02, 471.42, 333.11, 460.72, 378.31, 94.27, 319.4, 457.14, 73.66, 442.27, 207.97, 360.35, 415.32, 454.08, 391.88, 65.77, 459.16, 465.22, 240.7, 136.88, 450.38, 388.28, 418.96, 289.97, 357.2, 340.88, 279.37, 380.72, 468.08, 463.36, 469.75, 402.57, 471.76, 375.55, 389.54, 466.88, 366.54, 468.4, 192.08, 299.43, 466.15, 463.57,
#             163.37, 341.71, 358.14, 32.19, 467.54, 460.2, 354.4, 438.41, 453.52, 435.21, 467.15, 306.19, 51.1, 296.12, 400.89, 127.27, 474.97, 386.78, 241.05, 412.36, 436.54, 373.1, 231.71, 405.54, 463.52, 406.82, 444.54, 454.18, 461.77, 465.95, 467.97, 425.02, 430.38, 437.64, 370.52, 441.8, 388.24, 464.54, 430.25, 422.67, 414.82, 432.77, 392.35, 336.49, 429.99, 445.8, 411.14, 463.35, 156.92, 360.82, 463.88, 425.53, 454.34, 398.85, 384.05, 95.56, 457.97, 328.9, 376.92, 465.07, 428.06, 456.24, 467.73, 166.88, 376.2, 427.88, 243.0, 394.67, 419.32, 260.44, 465.9, 465.82, 384.46, 444.44, 218.89, 406.35, 404.92, 434.18, 263.51, 418.99, 449.02, 418.11, 473.98, 308.78, 386.41, 389.19, 253.8, 440.63, 439.48, 195.26, 367.58, 301.94, 391.06, 418.47, 453.02, 470.05, 470.3, 135.16, 462.23, 460.62, 219.47, 474.97, 426.61, 465.5, 384.46, 430.57, 366.04, 267.08, 23.88, 452.6, 467.98, 470.8, 459.13, 231.34, 461.0, 422.14, 215.95, 434.34, 360.94, 300.72, 462.57, 458.09, 293.04, 115.48, 446.4, 443.22, 457.39, 454.65, 416.64, 468.13, 349.49, 445.9, 301.89, 460.5, 51.55, 410.27, 459.59, 473.15, 348.56, 462.85, 422.76, 426.31, 471.25, 416.81, 459.46, 469.37, 470.48, 429.07, 400.22, 458.76, 459.96, 464.9, 453.33, 378.33, 105.0, 431.11, 320.64, 470.92, 454.58, 163.22, 373.4, 423.0, 457.89, 464.55, 473.27, 467.64, 466.64, 427.19, 328.2, 465.39, 291.22, 474.02, 469.66, 249.0, 465.98, 466.86, 459.16, 387.85, 386.32, 59.28, 444.87, 109.96, 467.81, 447.44, 426.95, 455.76, 339.7, 457.53, 402.01, 360.3, 408.25, 434.81, 455.87, 462.3, 407.53, 468.0, 465.39, 463.37, 361.13, 464.9, 470.53, 378.09, 413.18, 466.7, 440.37, 400.44, 469.16, 447.72, 451.21, 361.95, 350.5, 465.65, 448.63, 455.08, 462.94, 454.65, 395.66, 452.74, 455.61, 397.64, 461.52, 450.52, 176.73, 439.86, 151.95, 454.75, 435.84, 400.5, 225.49, 463.25, 128.37, 466.27, 330.76, 358.46, 266.11, 273.51, 466.07, 441.02, 407.15,
#             112.6, 404.35, 351.95, 470.4, 454.14, 353.3, 445.99, 416.09, 407.39, 467.52, 430.34, 455.73, 341.71, 472.15, 466.49, 468.8, 457.95, 307.05, 267.93, 292.69, 450.7, 357.68, 457.83, 469.7, 127.87, 472.58, 453.02, 8.61, 250.64, 350.32, 471.72, 447.54, 467.84, 366.83, 448.51, 386.02, 471.31, 377.12, 471.35, 468.22, 460.0, 459.2, 458.99, 454.95, 438.61, 470.59, 457.53, 330.07, 425.33, 452.25, 471.76, 387.93, 427.09, 357.83, 471.26, 13.6, 465.44, 421.59, 401.34, 413.83, 459.25, 440.03, 388.05, 451.45, 463.05, 464.26, 468.68, 419.42, 272.14, 473.58, 300.7, 416.27, 457.84, 154.39, 425.27, 471.41, 471.71, 407.2, 377.15, 455.56, 470.97, 40.66, 429.97, 365.06, 403.79, 412.98, 467.81, 442.99, 443.04, 404.52, 298.9, 347.77, 250.45, 447.89, 130.42, 464.57, 445.32, 436.9, 451.71, 353.92, 311.77, 377.0, 466.8, 422.09, 392.25, 441.04, 307.69, 455.33, 346.44, 467.56, 424.26, 415.74, 275.85, 358.49, 465.72, 391.04, 450.98, 466.83, 466.69, 48.18, 222.14, 85.93, 387.9, 193.59, 318.06, 455.34, 408.08, 439.29, 461.74, 306.52, 443.46, 123.59, 130.3, 374.09, 465.17, 463.04, 439.53, 115.59, 454.26, 417.4, 455.98, 460.03, 459.55, 241.21, 466.96, 351.78, 472.58, 466.52, 336.82, 439.67, 381.38, 402.71, 448.46, 472.09, 373.76, 323.53, 321.33, 421.41, 470.08, 39.01, 467.11, 440.64, 466.66, 304.72, 401.64, 29.71, 286.58, 277.89, 457.95, 439.47, 351.57, 425.0, 407.74, 432.59, 444.93, 46.1, 473.11, 412.24, 273.38, 447.28, 461.17, 257.58, 470.73, 374.36, 118.78, 434.27, 411.8]
# sig_sig = [473.36, 471.27, 258.58, 372.63, 450.46, 426.55, 436.51, 141.1, 456.09, 457.94, 458.62, 466.17, 400.91, 447.95, 194.59, 471.09, 454.59, 411.9, 473.33, 203.47, 470.05, 416.49, 473.96, 456.0, 394.65, 463.11, 424.43, 395.72, 466.77, 464.16, 457.15, 247.03, 461.07, 345.84, 393.27, 464.79, 472.31, 472.28, 433.39, 457.16, 460.91, 431.55, 470.65, 445.09, 471.45, 426.61, 377.92, 462.8, 391.97, 470.79, 470.55, 400.85, 464.4, 359.46, 462.1, 471.8, 454.68, 454.11, 466.67, 461.1, 375.54, 324.39, 95.18, 31.54, 440.84, 135.69, 185.43, 421.65, 464.7, 444.47, 431.31, 466.97, 459.26, 434.46, 396.73, 463.38, 430.51, 311.64, 85.65, 443.16, 448.82, 469.82, 407.16, 404.9, 386.37, 468.85, 455.29, 285.49, 446.91, 399.11, 468.52, 455.14, 426.48, 410.38, 321.48, 462.76, 467.75, 439.83, 472.19, 465.95, 471.3, 263.9, 247.33, 467.59, 437.56, 417.55, 463.4, 466.07, 449.18, 192.8, 335.48, 209.45, 468.64, 427.79, 436.74, 446.24, 399.56, 429.32, 431.99, 471.15, 445.75, 459.74, 163.25, 164.62, 406.07, 470.63, 449.08, 448.29, 442.3, 22.83, 205.82, 473.08, 474.04, 453.19, 241.14, 340.08, 461.04, 457.18, 448.09, 471.09, 403.52, 460.06, 472.07, 458.46, 329.95, 449.32, 320.11, 463.64, 464.79, 430.59, 469.24, 174.48, 468.85, 468.89, 447.31, 259.18, 308.64, 455.34, 466.14, 457.48, 463.38, 457.11, 411.55, 459.0, 467.74, 183.87, 319.57, 440.3, 428.09, 456.47, 353.64, 455.14, 473.2, 465.35, 468.77, 323.1, 452.1, 472.49, 475.47, 244.07, 449.25, 443.95, 469.61, 246.72, 468.06, 465.2, 471.92, 472.34, 457.75, 457.83, 427.38, 468.6, 473.96, 453.55, 314.65, 36.82, 464.15, 310.5, 276.72, 473.84, 467.82, 177.1, 469.04, 180.68, 460.2, 418.12, 390.71, 450.42, 441.1, 378.75, 437.34, 51.49, 446.25, 210.49, 472.16, 355.85, 468.15, 303.63, 141.18, 440.22, 473.02, 436.59, 426.58, 471.58, 264.88, 412.72, 79.54, 312.92, 439.28, 63.95, 447.45, 395.91, 469.19, 470.37, 440.28, 470.87, 332.51, 474.04, 466.13, 467.65, 343.4, 426.78, 473.01, 144.26, 288.3, 336.33, 90.38, 425.47, 435.92, 427.02, 429.02, 456.57, 121.05, 281.45, 462.4, 281.83, 441.74, 429.24, 451.94, 260.67, 455.08, 53.39, 429.64, 418.81, 322.73, 424.31, 432.44, 52.99, 355.11, 425.68, 439.56, 470.65, 457.02, 59.62, 399.28, 201.78, 469.19, 257.6, 468.28, 342.9, 282.34, 232.85, 193.63, 455.18, 431.33, 441.4, 450.0, 449.89, 458.04, 463.05, 458.14, 241.83, 376.66, 325.0, 450.41, 409.58, 468.33, 223.77, 447.93, 462.53, 466.99, 411.93, 471.54, 358.73, 284.57, 441.8, 458.61, 460.68, 283.54, 399.55, 171.85, 460.37, 398.57, 461.34, 446.62, 429.67, 319.32, 325.91, 93.43, 468.53, 289.53, 35.58, 450.37, 468.07, 433.22, 443.27, 361.3, 451.03, 395.84, 462.69, 205.8, 451.78, 455.31, 373.74, 428.55, 441.64, 470.95, 247.38, 388.36, 446.21, 292.7, 421.58, 378.35, 347.05, 436.42, 452.64, 288.93, 408.72, 462.06, 326.92, 454.9, 464.18, 412.56, 400.48, 467.86, 468.32, 451.01, 477.67, 467.83, 444.04, 469.41, 450.34, 423.16, 399.28, 437.38, 393.8, 279.98, 473.07, 472.79, 56.26, 118.03, 321.92, 18.83, 449.07, 456.5, 176.25, 467.91, 409.59, 412.36, 406.35, 26.22, 291.37, 6.35, 349.2, 446.94, 297.17, 467.39, 459.59, 355.93, 451.7, 351.81, 453.55, 461.03, 397.03, 449.48, 94.85, 470.04, 431.41, 434.34, 344.39, 442.37, 464.7, 419.91, 356.95, 467.83, 452.82, 424.11, 173.46, 471.6, 433.0, 436.71, 468.31, 469.43, 460.02, 451.53, 457.74, 457.62, 231.76, 333.58, 155.52, 418.76, 469.91, 411.86, 465.43, 442.95, 321.77, 410.82, 202.27, 369.63, 427.3, 427.08, 350.35, 459.47, 463.98, 468.1, 435.44, 458.03, 472.66, 257.27, 278.94, 460.88, 314.45, 442.22, 470.92, 471.42, 424.46, 423.41, 461.73, 460.65, 380.42, 232.63, 452.25, 244.5, 408.63, 304.31, 317.49, 323.75, 119.72, 349.81, 463.74, 56.41, 263.49, 221.57, 338.91, 394.63, 469.35, 457.73, 388.9, 293.08, 439.77, 399.2, 64.6, 128.34, 458.58, 450.86, 217.85, 425.25, 265.49, 447.82, 386.54, 362.26, 444.37, 379.11, 459.67, 449.19, 466.6, 472.56, 277.51, 346.38, 461.31, 472.46, 137.2, 470.5, 415.23, 470.56, 398.66, 429.63, 437.77, 200.87, 462.37, 181.33, 249.02, 466.75, 366.16, 285.73, 309.0, 119.43, 373.04, 387.98, 400.15, 446.71, 445.1, 461.99, 470.39, 110.45, 463.85, 365.27, 448.14, 96.77, 469.4, 343.08, 193.83, 467.23, 467.31, 357.04, 352.53, 468.26, 475.11, 439.95, 461.18, 263.11, 408.42, 450.62, 458.45, 459.48, 461.66, 448.86, 379.79, 446.39, 440.82, 396.56, 378.86, 467.34, 455.37, 450.58, 358.48, 231.57, 374.85, 456.62, 390.03, 475.0, 30.03, 443.89, 394.09, 375.97, 458.04, 472.23, 445.75, 465.19, 231.9, 457.38, 458.05, 460.88, 389.97, 463.79, 472.1, 459.49, 471.78, 183.4, 291.85, 221.23, 470.1, 451.96, 382.47, 262.61, 150.36, 463.8, 453.47, 213.41, 308.42, 464.08, 465.47, 362.25, 308.67, 473.23, 419.22, 405.17, 471.73, 450.19, 337.21, 213.64, 471.91, 468.32, 438.84, 471.49, 395.96, 466.77, 388.58, 444.32, 204.01, 378.3, 350.66, 325.35, 351.44, 440.14, 383.68, 443.93, 381.99, 461.84, 60.61, 469.4, 468.54, 241.51, 456.34, 464.54, 463.37, 205.72, 138.97, 448.73, 346.93, 471.65, 264.86, 261.25, 439.76, 471.55, 444.47, 460.04, 460.65, 287.56, 457.71, 408.62, 165.61, 152.97, 414.99, 466.0, 72.27, 323.63, 190.78, 323.38, 420.66, 370.16, 352.73, 368.6, 24.68, 295.67, 416.62, 407.95, 77.85, 461.06, 414.07, 344.36, 107.98, 473.65, 444.23, 466.36, 351.43, 61.74, 262.76, 467.71, 467.06, 467.29, 175.99, 438.9, 415.47, 433.67, 458.45, 164.26, 383.08, 441.39, 472.02, 302.48, 442.0, 425.34, 230.1, 196.03, 420.98, 402.11, 279.66, 389.55, 358.27, 464.98, 414.2, 138.04, 462.18, 463.49, 470.5, 438.35, 471.2, 467.08, 470.5, 155.56, 363.56, 462.13, 464.71, 246.35, 331.83, 458.49, 459.09, 425.51, 462.88, 467.84, 441.13, 463.53, 420.31, 238.9, 439.84, 252.59, 259.53, 21.13, 456.49, 84.36, 296.29, 460.3, 433.5, 450.14, 419.39, 401.85, 440.41, 432.34, 113.37, 408.56, 475.22, 459.18, 466.27, 465.13, 366.56, 32.25, 471.5, 399.92, 418.36, 258.03, 454.39, 444.77, 473.81, 365.05, 472.58, 242.36, 469.44, 44.37, 469.77, 459.56, 68.25, 464.61, 413.4, 473.05, 451.84, 424.86, 467.9, 451.23, 293.24, 358.73, 388.8, 283.09, 288.44, 468.6, 468.03, 473.78, 401.36, 347.69, 399.46, 467.24, 464.09, 442.62, 453.09, 345.25, 405.34, 220.22, 431.14, 390.09, 376.21, 411.81, 355.47, 408.32, 457.78, 417.84, 430.92, 467.15, 473.27, 431.12, 70.18, 448.46, 464.94, 378.07, 471.6, 386.04, 293.9, 454.18, 455.27, 192.07, 462.16, 420.77, 466.46, 460.76, 392.9, 455.67, 383.37, 410.62, 447.03, 373.44, 434.77, 469.79, 354.7, 445.55, 399.09, 432.98, 464.33, 446.83, 330.0, 470.27, 426.18, 383.04, 438.25, 460.75, 392.41, 256.58, 417.09, 269.45, 408.97, 470.11, 441.23, 320.3, 464.59, 452.3, 465.03, 446.86, 385.18, 391.36, 271.35, 438.72, 459.02, 473.94, 332.27, 434.73, 406.68, 335.92, 412.82, 412.58, 101.98, 420.4, 134.59, 399.57, 469.99, 379.91, 455.48, 396.18, 437.69, 473.53, 431.23, 411.96, 369.19, 16.58, 381.07, 370.95, 187.95, 231.47, 268.4, 387.75, 442.37, 400.63, 264.26, 403.03, 431.92, 28.87, 456.54, 430.33, 48.13, 424.35, 442.49, 429.73, 148.65, 463.65, 454.5, 424.13, 456.73, 467.76, 38.02, 468.94, 221.61, 420.95, 113.49, 470.46, 306.14, 211.34, 450.37, 359.19, 464.23, 404.57, 426.15, 467.28, 466.09, 466.8, 449.69, 466.39, 461.35, 148.27, 462.25, 470.46, 457.42, 360.64, 462.18, 352.9, 460.85, 314.88, 450.49, 126.84, 351.06, 453.68, 421.22, 150.56, 407.84, 28.5, 453.01, 468.0, 254.2, 462.35, 307.85, 298.7, 466.53, 410.76, 468.73, 463.11, 466.67, 460.0, 341.22, 461.76, 446.01, 252.02, 466.54, 407.45, 140.09, 467.83, 437.02, 437.73, 381.77, 469.58, 469.6, 387.87, 461.72, 399.71, 472.28, 122.85, 296.85, 474.46, 466.66, 446.15, 407.13, 418.47, 464.68, 467.53, 452.53, 255.62, 434.34, 465.18, 453.28, 453.04, 274.06, 306.32, 463.71, 469.06, 329.13, 376.32, 329.33, 342.24, 462.41, 422.1, 160.4, 466.75, 378.5, 388.18, 402.2, 373.76, 469.65, 462.34, 190.6, 392.57, 454.19, 421.43, 359.13, 463.58, 416.27, 373.74, 448.22, 471.81, 341.96, 41.39, 407.12, 323.65, 436.82, 203.83, 334.08, 215.38, 371.17, 461.61, 456.69, 279.78, 260.79, 466.55, 457.42, 407.87, 453.18, 461.93, 462.77, 473.69, 338.01, 468.3, 429.96, 438.94, 365.09, 456.92, 424.97, 390.08, 431.34, 468.13, 447.22, 338.29, 341.11, 423.93, 271.73, 450.79, 349.58, 324.44, 470.88, 451.05, 427.4, 435.82, 176.15, 463.79, 149.3, 456.74, 469.81, 466.95, 436.26, 447.01, 389.83, 35.41, 172.3, 468.17, 296.37, 224.71, 450.29, 384.84, 378.33, 412.25, 442.16, 456.85, 384.62, 339.39, 245.4, 457.57, 353.76, 284.5, 463.73, 398.82, 436.24, 442.15, 362.58, 460.5, 188.51, 462.35, 461.69, 310.17, 262.74, 457.6, 350.56, 102.0, 308.95, 276.04, 352.44, 268.03, 436.31, 463.63, 422.72, 445.0, 417.78, 444.17, 261.66, 463.6, 383.92, 437.85, 463.17, 455.51, 141.27, 362.48, 462.38, 200.8, 469.56, 271.81, 449.47, 466.05, 454.86, 297.85, 352.6, 460.75, 465.18, 414.5, 467.66, 462.99, 231.57, 465.12, 437.54, 439.64, 464.09, 450.94, 461.33, 453.07, 467.6, 292.79, 469.42, 251.93, 454.4, 405.82, 381.38, 422.43, 455.1, 397.34, 284.78, 104.89, 414.85, 458.41, 418.87, 373.35, 469.61, 334.17, 414.02, 463.15, 465.49, 104.02, 265.96, 465.03, 316.19, 451.32, 456.11, 156.87, 433.78, 464.23, 424.29, 436.49, 451.9, 422.25, 45.33, 171.71, 470.02, 451.45, 430.72, 444.37, 98.84, 468.43, 413.24, 356.14, 473.34, 371.64, 445.41, 446.18, 406.89, 465.69, 391.06, 422.04, 445.76, 291.62, 126.1, 459.32, 454.52, 449.15, 300.49, 423.17, 413.03, 425.13, 454.38, 114.45, 440.92, 439.08, 128.02, 24.34, 139.9, 38.31, 469.79, 471.56, 296.71, 369.87, 446.15, 412.14, 403.92, 272.97, 344.15, 451.3, 458.54, 380.36, 466.2, 177.3, 431.49, 355.41, 359.06, 274.55, 451.34, 206.37, 436.21, 219.23, 467.19, 410.51, 471.62, 431.83, 469.37, 357.47, 461.34, 416.78, 467.86, 279.9, 154.49, 462.19, 25.72, 207.35, 437.7, 460.88, 379.1, 401.94, 468.34, 109.52, 428.16, 243.21, 441.04, 352.34, 469.25, 428.01, 262.46, 298.63, 446.14, 379.99, 151.38, 429.0, 441.68, 445.03, 467.68, 319.0, 433.71, 448.63, 459.85, 395.09, 339.21, 432.84, 467.06, 34.56, 337.81, 184.85, 163.22, 465.45, 428.91, 473.3, 464.33, 212.07, 385.86, 427.09, 393.92, 468.54, 436.52, 204.31, 469.26, 123.84, 469.33, 465.95, 475.04, 334.27, 325.79, 
# 382.26, 33.84, 443.79, 181.63, 445.28, 469.27, 418.95, 141.49, 454.86, 472.17, 459.2, 475.93, 438.44, 468.05, 422.47, 464.96, 184.65, 460.66, 430.42, 454.64, 106.27, 465.52, 296.03, 232.61, 390.56, 61.41, 307.22, 431.75, 432.03, 140.73, 33.33, 441.54, 405.71, 390.35, 429.21, 457.19, 442.62, 420.78, 463.17, 65.09, 333.83, 422.46, 473.28, 401.93, 442.45, 404.16, 429.72, 437.07, 467.82, 463.9, 465.29, 226.42, 224.3, 296.0, 130.67, 372.7, 443.18, 448.86, 464.85, 473.01, 469.38, 221.32, 425.12, 293.41, 423.01, 344.04, 345.06, 461.06, 366.04, 316.17, 362.3, 398.38, 470.89, 205.04, 322.99, 337.97, 417.47, 108.33, 333.79, 459.8, 327.02, 458.08, 439.47, 456.16, 112.49, 460.02, 109.64, 114.74, 470.09, 463.96, 294.95, 452.57, 463.52, 456.82, 409.13, 423.14, 274.09, 173.06, 471.18, 440.52, 425.27, 435.04, 459.9, 468.54, 248.51, 282.77, 465.97, 158.31, 425.7, 462.71, 469.68, 451.23, 469.66, 176.02, 368.4, 241.93, 427.03, 471.18, 416.63, 354.06, 468.48, 460.59, 447.78, 470.59, 455.84, 389.67, 473.03, 468.86, 462.88, 470.15, 276.69, 409.57, 175.14, 437.54, 459.66, 411.62, 405.49, 471.47, 267.78, 412.22, 459.04, 446.27, 454.86, 221.57, 455.8, 350.36, 87.29, 16.98, 443.36, 459.97, 368.31, 467.15, 471.45, 343.9, 468.16, 468.25, 468.61, 279.69, 400.66, 459.56, 330.8, 411.77, 351.06, 70.75, 427.62, 400.76, 465.82, 408.22, 463.07, 472.38, 455.08, 365.36, 193.14, 56.51, 389.06, 373.22, 466.6, 159.52, 444.43, 388.58, 465.92, 371.13, 433.49, 257.78, 350.67, 424.09, 419.24, 456.62, 412.37, 453.64, 430.29, 195.37, 452.58, 391.79, 463.75, 425.04, 472.68, 355.95, 431.95, 460.65, 444.77, 460.99, 172.47, 436.24, 463.3, 472.57, 457.29, 249.39, 323.05, 467.21, 446.14, 312.38, 384.2, 402.48, 261.05, 290.47, 277.43, 471.0, 316.25, 473.5, 305.4, 280.27, 471.2, 25.97, 410.1, 453.0, 421.97, 370.69, 410.49, 466.44, 463.37, 407.21, 469.02, 467.62, 450.41, 451.6, 360.44, 379.95, 148.44, 292.56, 457.04, 106.58, 463.98, 469.06, 438.89, 367.91, 449.44, 467.3, 465.02, 467.43, 436.76, 271.23, 451.5, 338.06, 407.29, 445.2, 459.28, 83.54, 342.94, 361.81, 465.01, 440.5, 434.33, 454.66, 440.05, 387.83, 368.55, 469.48, 309.83, 461.61, 452.66, 454.66, 468.36, 428.2, 447.87, 467.12, 464.66, 392.74, 473.24, 422.51, 321.41, 85.54, 459.58, 323.99, 361.26, 467.85, 137.01, 403.22, 473.03, 443.37, 469.54, 344.92, 443.39, 462.23, 129.33, 469.03, 334.66, 464.9, 398.35, 434.45, 412.17, 432.33, 423.41, 20.97, 458.52, 446.73, 120.74, 438.61, 389.89, 143.2, 369.78, 402.58, 424.19, 389.02, 439.87, 232.43, 461.6, 375.32, 266.98, 414.64, 353.24, 460.29, 384.27, 384.42, 462.37, 289.46, 384.56, 395.33, 281.61, 426.56, 471.23, 443.42, 450.1, 458.11, 149.04, 459.52, 182.99, 442.07, 290.94, 469.12, 412.77, 442.03, 362.82, 351.47, 232.88, 442.19, 67.75, 460.69, 443.97, 88.27, 65.32, 426.8, 472.25, 400.38, 461.14, 450.28, 411.77, 359.11, 465.06, 284.76, 87.52, 460.5, 432.35, 179.26, 451.26, 460.37, 468.05, 266.4, 435.27, 285.4, 403.66, 341.13, 322.38, 453.23, 453.99, 445.75, 426.79, 290.41, 318.41, 463.16, 471.01, 430.15, 464.31, 436.5, 464.85, 414.74, 454.14, 470.94, 449.81, 175.85, 273.75, 160.42, 315.59, 444.88, 399.39, 460.17, 397.52, 418.49, 157.76, 471.32, 276.19, 433.13, 460.48, 472.86, 340.35, 318.65, 429.02, 462.71, 305.37, 426.13, 323.36, 392.09, 462.36, 449.85, 451.53, 379.66, 455.28, 459.04, 433.91, 432.74, 457.81, 460.39, 370.36, 474.59, 467.0, 27.5, 464.73, 472.11, 57.25, 423.4, 458.4, 387.13, 442.24, 423.7, 419.97, 388.71, 441.75, 463.74, 382.54, 449.67, 339.79, 471.54, 447.46, 439.37, 213.76, 465.06, 476.4, 140.68, 461.59, 458.19, 459.62, 343.43, 351.69, 461.05, 382.84, 423.41, 468.04, 468.95, 454.49, 280.65, 261.56, 414.85, 460.95, 240.92, 467.34, 384.61, 404.88, 463.77, 349.26, 124.37, 209.85, 250.03, 338.82, 385.12, 329.05, 461.4, 467.75, 305.77, 440.36, 447.28, 434.29, 460.76, 470.93, 253.39, 387.97, 453.76, 462.22, 433.39, 108.61, 24.87, 393.99, 442.49, 473.45, 293.58, 266.28, 465.58, 263.32, 111.77, 412.71, 471.5, 468.23, 444.19, 275.98, 168.45, 132.7, 391.57, 448.61, 462.83, 414.74, 454.82, 381.95, 393.87, 461.31, 386.71, 379.61, 457.18, 472.06, 415.4, 397.55, 470.93, 379.61, 421.66, 461.06, 392.88, 469.75, 472.07, 376.69, 391.5, 466.52, 472.29, 470.94, 452.53, 435.8, 155.51, 448.59, 179.63, 348.62, 378.56, 449.04, 469.57, 385.18, 320.26, 376.13, 89.56, 452.76, 235.58, 472.01, 351.4, 445.71, 456.53, 444.53, 345.69, 419.71, 418.47, 266.56, 451.47, 355.76, 332.49, 452.21, 472.59, 435.86, 464.76, 463.46, 422.89, 414.61, 259.97, 375.59, 363.68, 432.17, 277.77, 423.85, 94.11, 463.45, 465.38, 466.32, 473.15, 468.4, 472.17, 439.0, 20.54, 446.35, 377.3, 10.82, 377.54, 352.33, 349.0, 285.16, 443.12, 71.18, 382.92, 387.62, 380.75, 440.77, 443.22, 386.63, 468.31, 9.34, 127.77, 164.74, 470.14, 420.88, 468.79, 437.08, 449.91, 448.08, 450.78, 413.07, 451.13, 447.01, 367.09, 298.8, 458.86, 463.38, 396.42, 405.4, 439.4, 381.33, 465.18, 448.47, 28.34, 4.54, 466.32, 362.49, 69.26, 171.19, 324.38, 154.54, 319.62, 347.15, 277.45, 425.32, 458.3, 430.36, 460.4, 443.86, 424.36, 458.55, 454.21, 470.52, 228.19, 464.06, 423.17, 224.49, 386.7, 374.27, 77.52, 411.31, 195.51, 463.97, 462.09, 397.49, 251.82, 438.02, 473.13, 355.19, 333.05, 471.8, 455.52, 341.07, 471.54, 340.74, 259.91, 471.54, 470.59, 404.29, 325.21, 446.06, 301.72, 412.22, 452.17, 446.56, 458.41, 213.51, 436.43, 466.63, 262.18, 401.49, 450.28, 293.1, 46.87, 431.1, 436.65, 323.82, 407.12, 457.72, 469.85, 314.44, 469.56, 376.89, 350.82, 476.03, 448.71, 427.44, 406.4, 449.71, 386.67, 456.04, 469.93, 289.23, 404.2, 463.14, 40.5, 383.8, 468.55, 466.67, 468.71, 321.52, 447.72, 464.06, 461.84, 395.88, 424.82, 461.95, 461.66, 459.23, 238.67, 450.59, 469.36, 287.24, 385.31, 84.03, 436.73, 435.75, 426.18, 173.11, 405.62, 401.95, 120.91, 333.97, 359.93, 467.88, 445.78, 427.69, 458.85, 470.35, 438.14, 431.98, 464.23, 405.73, 462.02, 367.44, 121.71, 457.11, 438.11, 467.75, 381.1, 419.86, 468.57, 275.82, 345.0, 271.66, 281.6, 468.56, 470.05, 459.23, 240.23, 447.89, 132.15, 454.06, 469.12, 204.95, 437.49, 317.06, 471.08, 437.68, 384.51, 465.53, 409.6, 471.32, 354.18, 446.76, 449.1, 395.6, 189.31, 451.74, 415.12, 132.32, 301.16, 467.55, 205.93, 209.57, 349.22, 471.95, 207.85, 427.98, 336.82, 135.84, 151.0, 407.69, 178.63, 418.69, 463.98, 461.06, 470.87, 387.68, 327.63, 466.73, 473.62, 392.38, 469.82, 415.06, 414.75, 429.67, 52.49, 463.85, 114.66, 308.03, 431.7, 8.12, 445.62, 375.62, 421.82, 420.24, 439.56, 379.24, 428.14, 407.81, 267.0, 177.85, 465.32, 474.77, 315.39, 374.12, 426.41, 470.42, 424.08, 441.33, 468.51, 316.78, 290.98, 471.28, 320.54, 441.42, 370.03, 363.06, 412.43, 455.5, 352.87, 463.95, 410.27, 460.99, 455.47, 470.14, 398.98, 456.11, 350.09, 459.54, 392.77, 278.0, 417.75, 192.02, 124.07, 456.54, 463.32, 14.93, 366.19, 443.98, 464.29, 120.36, 466.49, 350.17, 23.18, 461.91, 366.74, 434.07, 224.56, 459.47, 469.37, 462.79, 462.19, 225.62, 413.58, 389.86, 403.13, 443.19, 447.9, 459.05, 465.81, 451.8, 455.12, 446.39, 311.85, 307.1, 256.44, 448.01, 216.37, 165.45, 447.19, 357.55, 465.25, 470.07, 372.16, 403.08, 468.24, 467.77, 468.03, 463.57, 469.57, 463.37, 450.05, 472.29, 469.49, 407.85, 409.08, 388.05, 454.34, 469.47, 437.58, 445.1, 384.9, 414.91, 60.46, 436.26, 381.32, 395.58, 334.54, 96.04, 455.98, 465.5, 449.45, 463.76, 465.14, 466.28, 470.77, 415.39, 401.37, 233.4, 471.02, 468.05, 467.59, 396.46, 465.25, 465.88, 432.78, 384.69, 187.93, 402.8, 461.79, 444.1, 468.7, 469.11, 419.08, 450.83, 432.61, 440.65, 463.42, 365.91, 419.3, 220.58, 429.95, 469.45, 444.16, 471.6, 471.43, 272.77, 466.33, 465.91, 160.85, 440.04, 297.12, 442.99, 156.43, 456.77, 201.9, 459.13, 421.82, 460.09, 401.87, 461.69, 455.5, 471.77, 147.46, 306.72, 32.85, 10.81, 384.59, 445.4, 467.0, 407.4, 468.49, 439.09, 442.49, 464.65, 474.36, 463.06, 257.13, 285.76, 375.51, 332.6, 404.81, 387.27, 465.95, 376.62, 441.08, 469.31, 428.14, 276.02, 464.16, 423.44, 374.37, 381.15, 188.55, 426.03, 409.15, 393.77, 443.54, 197.9, 246.52, 455.87, 446.07, 461.85, 443.65, 459.13, 461.45, 358.56, 422.45, 239.79, 167.53, 416.79, 51.41, 465.44, 294.46, 433.4, 415.65, 112.41, 388.75, 325.66, 458.54, 375.35, 59.7, 157.56, 269.24, 456.71, 460.48, 456.18, 304.31, 462.92, 333.74, 405.84, 404.45, 213.17, 470.21, 445.76, 22.47, 434.76, 417.9, 456.74, 440.73, 373.32, 472.81, 467.99, 335.93, 408.26, 133.89, 383.27, 467.05, 437.73, 457.12, 372.43, 416.86, 446.6, 449.35, 440.13, 370.62, 429.5, 461.35, 327.13, 467.9]
# sig_med = np.median(sig_sig)

# # sig_lin = [6.89, 444.2, 472.64, 4.74, 450.13, 9.3, 28.03, 170.41, 366.79, 339.16, 56.29, 410.69, 2.25, 439.38, 465.42, 459.74, 468.09, 129.95, 414.0, 454.13, 259.13, 25.54, 23.29, 245.69, 89.89, 428.95, 4.4, 175.88, 3.92, 12.76, 18.81, 49.42,
# #             24.68, 401.44, 447.05, 336.05, 63.21, 2.37, 95.45, 4.76, 409.71, 190.19, 44.72, 3.99, 3.36, 410.34, 16.9, 391.47, 376.95, 470.42, 457.06, 378.24, 6.31, 3.44, 465.77, 13.53, 405.65, 1.23, 448.45, 452.12, 451.28, 365.39, 455.31, 5.1, 453.2, 291.57, 45.82, 25.78, 57.26, 306.45, 389.49, 12.5,
# #             219.68, 468.01, 42.48, 151.06, 464.56, 460.0, 451.45, 470.91, 144.26, 1.21, 6.69, 439.02, 419.67, 343.53, 148.73, 135.75, 26.7, 51.66, 224.46, 12.99, 2.29, 82.2, 2.47, 8.72, 6.94,
# #             13.43, 329.1, 129.96, 2.83, 1.42, 1.91, 326.37, 436.82, 116.67, 392.8, 163.11, 1.83, 406.81, 75.35, 453.76, 470.59, 49.17, 356.7, 75.67, 241.61, 144.62, 454.25, 171.63, 374.36, 435.65, 424.27, 293.15, 113.8, 20.14, 10.23, 20.85, 1.91, 9.12, 5.61, 8.98,
# #             434.22, 349.19, 342.58, 5.25, 385.47, 35.62, 136.34, 145.26, 468.17, 372.07, 466.52, 319.78, 320.84, 13.26, 3.8, 207.3, 9.69, 7.76, 402.04, 13.32, 349.01, 14.61, 1.93, 5.19, 33.52, 99.44, 87.52]
# sig_lin = [77.06, 451.38, 117.98, 470.19, 99.02, 3.81, 17.83, 310.88, 57.24, 326.38, 335.41, 314.98, 6.48, 10.1, 168.6, 453.68, 438.54, 16.64, 79.65, 465.51, 1.2, 471.68, 468.37, 313.43, 134.87, 464.37, 328.07, 447.44, 407.04, 4.23, 331.6, 376.35, 391.5, 25.58, 91.9, 162.0, 470.32, 467.57, 463.74, 81.87, 283.99, 3.64, 427.11, 351.27, 39.9, 4.92, 384.96, 260.98, 85.91, 43.76, 452.89, 357.92, 374.22, 1.23, 417.93, 28.93, 25.69, 10.6, 201.15, 376.01, 429.67, 414.79, 459.48, 468.5, 460.57, 470.22, 30.87, 393.36, 466.89, 10.21, 2.24, 231.88, 79.16, 111.02, 61.51, 37.68, 425.28, 288.88, 316.43, 387.14, 437.5, 410.6, 453.89, 395.27, 349.27, 457.44, 442.33, 69.84, 463.49, 18.24, 54.03, 468.66, 2.2, 6.49, 459.51, 372.53, 2.54, 178.3, 1.28, 1.74, 464.38, 394.6, 471.73, 464.04, 407.38, 423.34, 306.06, 298.94, 413.48, 473.62, 473.3, 1.29, 18.27, 299.36, 16.69, 440.38, 393.19, 193.95, 204.16, 4.56, 398.24, 124.37, 211.14, 1.03, 404.73, 462.91, 409.65, 446.99, 456.73, 192.95, 112.14, 4.88, 38.13, 5.5, 263.04, 241.78, 467.61, 67.37, 2.71, 374.49, 2.88, 462.94, 293.09, 341.1, 433.22, 423.66, 149.72, 387.98, 3.81, 1.67, 2.82, 207.96, 13.08, 198.85, 378.48, 442.34, 102.26, 176.61, 409.4, 89.84, 17.36, 470.56, 195.69, 7.05, 457.28, 1.91, 38.09, 137.36, 223.77, 48.98, 398.22, 398.82, 398.6, 27.29, 33.07, 51.89, 4.19, 300.24, 422.89, 426.53, 416.49, 2.25, 257.09, 1.46, 103.86, 461.37, 2.86, 3.64, 321.53, 403.45, 42.3, 470.46, 336.97, 309.78, 286.75, 339.73, 439.87, 1.38, 1.57, 1.62, 14.23, 21.34, 5.89, 1.11, 79.31, 237.01, 21.92, 359.73, 403.92, 116.06, 441.43, 89.94, 288.57, 350.54, 39.9, 439.48, 1.75, 147.7, 435.57, 38.03, 3.4, 1.09, 7.98, 5.45, 70.78, 5.47, 7.9, 38.15, 1.06, 177.59, 452.95, 108.37, 12.6, 318.4, 307.9, 451.21, 65.33, 2.63, 229.48, 394.5, 204.36, 1.18, 288.47, 80.86, 12.46, 167.99, 365.42, 471.51, 461.6, 311.61, 333.33, 450.93, 429.6, 23.75, 168.8, 21.78, 1.38, 401.99, 417.59, 4.67, 432.4, 28.39, 34.27, 393.15, 374.22, 4.16, 1.89, 136.16, 15.79, 28.6, 441.64, 462.05, 460.77, 476.31, 300.38, 467.63, 472.85, 447.75, 377.54, 301.66, 15.62, 343.06, 232.35, 1.41, 3.14, 51.08, 138.17, 1.28, 320.92, 2.97, 2.74, 110.72, 467.65, 470.44, 476.07, 30.18, 96.67, 432.24, 469.98, 462.25, 240.11, 447.91, 302.15, 1.83, 3.72, 144.62, 63.8, 244.09, 69.02, 450.67, 15.3, 167.99, 29.36, 137.95, 262.21, 4.71, 63.97, 418.68, 384.07, 1.13, 346.88, 278.19, 367.25, 43.98, 399.29, 6.36, 380.09, 71.05, 469.29, 237.06, 347.72, 299.64, 210.95, 29.86, 100.69, 135.91, 387.14, 451.1, 23.9, 233.9, 287.09, 56.9, 223.36, 399.36, 197.81, 285.87, 199.95, 147.38, 407.2, 466.76, 465.9, 462.95, 415.14, 275.74, 454.4, 2.0, 446.0, 44.78, 456.3, 1.43, 450.03, 66.85, 2.92, 17.41, 24.25, 453.17, 2.57, 4.14, 465.15, 19.95, 4.04, 208.14, 40.71, 458.29, 374.48, 424.77, 310.33, 377.6, 415.45, 272.99, 353.14, 434.62, 21.13, 419.75, 430.54, 80.52, 159.5, 469.99, 397.19, 328.84, 416.22, 12.27, 428.7, 439.38, 427.17, 415.79, 2.8, 465.16, 444.0, 344.67, 447.07, 469.72, 60.22, 463.17, 168.06, 468.44, 3.84, 5.63, 230.91, 122.03, 92.35, 435.3, 458.82, 473.35, 3.24, 384.24, 394.14, 4.65, 462.19, 464.12, 12.05, 432.77, 185.13, 465.77, 88.89, 466.5, 400.39, 434.52, 444.08, 447.57, 370.48, 373.2, 451.06, 22.15, 433.93, 451.47, 451.14, 318.2, 466.7, 85.17, 409.24, 354.33, 471.84, 472.21, 465.09, 382.87, 189.97, 456.67, 452.87, 242.31, 22.58, 33.5, 57.08, 128.31, 1.69, 9.43, 103.53, 135.21, 244.46, 273.98, 246.38, 1.18, 264.96, 429.55, 462.17, 7.56, 28.02, 459.37, 2.74, 21.06, 46.6, 44.87, 460.11, 5.03, 462.72, 68.76, 276.26, 443.99, 169.28, 431.63, 2.64, 455.84, 396.24, 463.9, 424.64, 468.14, 105.96, 470.99, 337.23, 453.0, 463.09, 31.39, 71.19, 460.06, 3.72, 463.28, 292.87, 2.05, 71.51, 93.62, 214.98, 239.27, 114.29, 238.26, 208.46, 3.47, 145.3, 7.87, 264.51, 29.92, 331.34, 47.82, 20.29, 13.27, 120.24, 435.5, 449.47, 1.34, 359.87, 83.03, 385.87, 259.17, 116.88, 343.87, 244.0, 175.54, 101.1, 414.29, 348.21, 2.19, 9.88, 33.82, 2.96, 471.45, 467.2, 59.76, 476.81, 470.23, 57.23, 407.31, 128.93, 379.07, 80.72, 105.51, 415.78, 406.99, 377.77, 410.5, 263.17, 414.88, 228.27, 449.5, 452.87, 33.1, 25.69, 206.35, 358.02, 239.27, 369.14, 450.89, 433.47, 101.21, 443.95, 460.11, 1.52, 256.47, 336.53, 442.8, 398.56, 365.64, 184.88, 1.05, 251.06, 280.0, 46.71, 57.22, 49.17, 448.34, 14.21, 7.54, 167.31, 3.28, 2.81, 378.05, 224.39, 471.7, 24.49, 220.92, 472.74, 81.94, 1.75, 324.79, 473.4, 460.56, 16.26, 295.16, 208.38, 1.82, 469.68, 231.46, 133.1, 224.01, 20.75, 40.46, 464.69, 46.35, 466.38, 17.65, 3.25, 396.91, 390.5, 249.52, 6.65, 19.03, 1.09, 1.24, 469.39, 358.2, 472.9, 298.96, 433.39, 449.75, 428.01, 255.31, 294.78, 111.21, 335.98, 5.79, 4.95, 109.5, 1.94, 1.2, 107.98, 226.39, 380.37, 2.41, 2.04, 66.92, 462.74, 300.38, 101.16, 229.17, 396.73, 416.95, 95.6, 1.04, 399.89, 458.09, 1.09, 261.49, 289.57, 337.67, 354.74, 413.34, 360.78, 437.1, 312.41, 35.84, 392.13, 10.55, 225.6, 4.53, 364.07, 37.76, 393.63, 144.37, 12.66, 461.01, 474.49, 465.22, 419.15, 454.88, 390.47, 59.16, 205.67, 155.53, 185.57, 2.51, 386.94, 414.58, 194.07, 166.35, 1.38, 1.3, 3.87, 5.84, 321.61, 17.1, 435.75, 31.19, 2.05, 222.15, 1.25, 19.89, 346.52, 78.87, 65.39, 383.08, 56.38, 25.3, 382.67, 354.2, 245.38, 133.98, 287.14, 9.45, 100.94, 141.38, 48.34, 79.41, 56.51, 468.77, 435.02, 96.79, 464.8, 247.63, 207.47, 360.31, 368.12, 465.96, 451.99, 22.2, 28.09, 106.09, 4.41, 240.93, 42.51, 1.32, 177.27, 6.49, 473.06, 472.27, 74.32, 443.68, 10.85, 2.69, 15.49, 59.79, 14.9, 21.04, 85.82, 285.7, 432.1, 97.26, 375.92, 450.88, 14.52, 6.06, 22.03, 294.11, 249.63, 23.15, 4.93, 459.45, 6.88, 1.88, 470.51, 33.2, 322.51, 397.22, 260.79, 1.91, 55.37, 414.42, 3.82, 4.88, 436.67, 241.26, 4.01, 3.01, 438.27, 8.42, 1.09, 371.0, 317.26, 266.53, 20.21, 97.28, 400.43, 461.09, 160.64, 458.48, 56.92, 136.06, 8.84, 41.77, 37.49, 447.02, 12.25, 195.15, 5.65, 96.87, 463.89, 463.82, 442.68, 202.25, 97.12, 390.48, 165.94, 369.32, 442.69, 394.3, 153.55, 314.29, 459.32, 444.29, 13.87, 293.69, 88.67, 355.72, 7.96, 344.2, 418.27, 455.27, 437.44, 454.12, 399.32, 3.26, 8.52, 229.25, 448.77, 454.55, 458.04, 14.15, 417.68, 10.66, 169.81, 425.16, 3.31, 256.01, 6.23, 14.19, 442.03, 105.67, 102.58, 42.81, 213.3, 441.93, 462.92, 297.92, 340.79, 438.17, 11.98, 226.05, 285.09, 32.74, 39.26, 370.02, 47.24, 466.57, 10.32, 2.09, 1.94, 272.67, 3.07, 253.84, 29.81, 452.91, 165.45, 330.42, 154.55, 220.08, 297.8, 106.15, 455.53, 341.3, 256.5, 6.5, 457.89, 34.43, 23.26, 39.28, 63.78, 468.68, 124.53, 400.33, 346.32, 467.17, 423.92, 454.14, 464.06, 308.9, 461.16, 373.28, 472.59, 466.18, 238.74, 417.67, 24.78, 432.76, 444.55, 460.98, 457.08, 469.68, 470.52, 418.12, 471.08, 452.94, 55.92, 454.65, 451.08, 392.35, 396.35, 232.28, 5.23, 360.18, 243.22, 364.36, 369.92, 28.15, 31.16, 224.28, 453.12, 5.49, 371.2, 205.02, 227.79, 387.1, 327.66, 3.37, 181.5, 3.91, 442.2, 5.09, 21.31, 346.38, 1.63, 3.9, 459.58, 446.2, 241.69, 458.41, 455.38, 1.89, 450.56, 89.34, 16.11, 26.94, 7.01, 60.28, 15.42, 412.16, 159.25, 7.01, 159.18, 6.2, 465.09, 469.26, 308.01, 324.36, 123.6, 19.8, 452.8, 447.86, 66.21, 10.25, 170.19, 49.1, 358.04, 456.19, 101.19, 450.07, 17.85, 309.51, 465.13, 468.43, 318.02, 196.72, 310.26, 23.72, 18.83, 470.47, 100.93, 351.89, 8.86, 145.31, 462.1, 1.71, 177.58, 448.45, 17.37, 409.31, 449.37, 22.98, 229.32, 411.64, 472.6, 471.49, 370.8, 439.76, 458.3, 337.84, 11.91, 429.46, 39.3, 98.29, 424.83, 4.02, 347.93, 1.07, 129.98, 13.8, 26.12, 16.5, 158.39, 311.24, 429.14, 22.71, 364.37, 455.66, 439.81, 278.51, 6.02, 410.52, 79.89, 52.2, 2.08, 322.03, 273.9, 287.27, 35.08, 429.43, 419.75, 420.98, 311.46, 182.4, 412.17, 256.43, 2.97, 135.2, 330.07, 463.0, 448.5, 43.73, 16.72, 1.17, 23.28, 3.39, 285.88, 387.06, 1.37, 466.82, 407.51, 328.18, 4.72, 192.64, 429.88, 460.69, 4.59, 464.11, 304.52, 431.2, 456.7, 448.92, 34.2, 413.13, 420.98, 458.86, 465.87, 127.64, 444.91, 1.18, 18.66, 469.67, 268.67, 57.13, 471.81, 7.11, 10.17, 288.59, 150.39, 470.76, 76.81, 470.19, 19.01, 27.72, 457.0, 28.27, 445.17, 20.93, 398.94, 9.08, 153.94, 364.53, 465.6, 298.37, 470.82, 418.61, 455.14, 273.74, 436.07, 44.85, 247.17, 33.27, 326.94, 19.74, 364.29, 3.55, 2.98, 19.02, 31.61, 468.22, 472.08, 464.73, 4.68, 158.51, 8.98, 437.51, 15.74, 6.24, 2.19, 38.47, 443.25, 298.64, 39.77, 1.91, 26.56, 178.2, 437.68, 2.27, 72.4, 73.2, 5.41, 19.92, 452.39, 112.76, 25.6, 367.36, 134.17, 390.57, 24.39, 352.38, 418.15, 424.8, 391.3, 103.52, 453.44, 7.67, 465.46, 109.81, 415.67, 1.46, 6.71, 
# 387.14, 3.4, 276.09, 4.85, 458.28, 4.16, 198.91, 432.92, 469.28, 471.59, 23.73, 440.0, 277.34, 461.06, 466.85, 466.92, 426.04, 7.1, 469.27, 76.42, 464.45, 370.26, 121.92, 142.84, 219.2, 462.86, 460.22, 377.39, 458.25, 1.52, 383.58, 399.3, 473.2, 472.62, 1.94, 461.45, 24.35, 427.67, 13.87, 402.91, 309.59, 96.38, 52.63, 295.87, 293.65, 173.46, 338.68, 130.58, 19.42, 82.36, 451.98, 459.78, 404.06, 9.13, 145.01, 12.94, 78.45, 298.91, 209.04, 367.79, 8.22, 320.05, 129.35, 461.4, 21.51, 20.14, 193.43, 124.61, 1.63, 66.25, 421.69, 132.58, 21.77, 94.43, 347.13, 6.94, 133.91, 1.25, 113.93, 273.19, 355.5, 1.81, 1.68, 196.99, 382.16, 52.63, 458.13, 4.09, 426.56, 7.31, 227.95, 79.45, 61.88, 444.64, 3.25, 52.93, 76.01, 17.12, 424.8, 309.67, 97.76, 69.15, 430.78, 142.12, 238.2, 378.1, 443.08, 11.21, 9.49, 460.65, 331.39, 412.03, 439.57, 19.71, 6.72, 301.58, 142.7, 418.68, 288.22, 456.28, 1.31, 2.61, 3.76, 141.01, 444.0, 461.57, 365.35, 275.75, 393.41, 28.35, 28.26, 57.92, 468.91, 46.72, 404.0, 40.5, 10.37, 462.65, 1.19, 313.29, 169.51, 16.31, 341.4, 33.72, 12.47, 129.35, 228.07, 430.74, 1.39, 205.57, 11.2, 7.28, 438.1, 467.74, 425.35, 471.03, 7.14, 285.45, 451.41, 120.82, 18.78, 379.5, 284.19, 377.57, 105.15, 252.22, 106.71, 6.02, 68.37, 3.6, 348.14, 403.47, 449.77, 10.39, 440.05, 135.78, 431.83, 460.15, 470.13, 211.39, 148.65, 329.39, 231.66, 324.06, 5.12, 400.8, 292.71, 414.91, 8.91, 3.84, 159.43, 438.93, 254.71, 29.68, 461.55, 395.2, 98.05, 226.61, 77.33, 204.06, 3.13, 434.67, 382.37, 44.16, 348.41, 15.91, 468.67, 133.17, 445.07, 465.85, 413.9, 401.04, 69.74, 0.99, 461.2, 59.67, 39.71, 448.25, 1.29, 372.89, 465.18, 1.3, 397.48, 444.16, 19.97, 151.59, 456.16, 1.55, 343.9, 469.05, 5.56, 14.47, 55.26, 135.54, 449.28, 213.45, 357.4, 463.25, 446.04, 338.64, 464.52, 164.62, 1.7, 2.76, 421.34, 439.67, 1.05, 444.62, 97.98, 162.5, 336.69, 473.65, 142.26, 473.4, 466.47, 15.74, 198.52, 395.68, 45.83, 417.25, 98.74, 431.99, 54.79, 26.95, 269.27, 35.22, 462.0, 340.14, 46.0, 450.14, 446.2, 7.94, 422.56, 3.1, 453.54, 5.17, 254.32, 200.34, 264.89, 416.71, 273.58, 250.79, 322.02, 40.07, 348.1, 343.16, 433.7, 414.02, 431.29, 0.92, 413.55, 1.27, 13.14, 220.69, 34.73, 7.48, 92.31, 41.9, 6.58, 312.62, 1.67, 260.73, 4.21, 332.2, 322.36, 438.38, 110.77, 474.47, 278.7, 205.17, 60.23, 426.06, 3.73, 424.35, 20.39, 7.75, 455.59, 291.91, 47.02, 1.56, 269.16, 297.04, 4.09, 17.64, 225.78, 466.39, 4.23, 157.62, 65.82, 342.27, 105.02, 31.2, 406.65, 460.97, 228.29, 443.04, 444.45, 6.0, 158.39, 182.58, 223.68, 466.97, 367.66, 1.17, 327.26, 9.86, 8.03, 1.41, 72.23, 325.91, 3.9, 72.02, 12.68, 1.75, 94.61, 125.79, 257.81, 5.99, 423.11, 358.59, 449.31, 362.05, 433.19, 40.27, 456.02, 420.03, 452.36, 115.47, 449.41, 71.84, 427.83, 42.69, 99.64, 435.16, 472.25, 472.77, 312.13, 17.83, 358.5, 462.85, 416.74, 300.93, 12.69, 287.24, 12.34, 250.12, 43.59, 2.81, 1.76, 3.05, 71.15, 105.71, 299.39, 30.51, 469.58, 14.98, 435.21, 2.05, 56.05, 467.68, 448.26, 412.2, 167.82, 191.41, 450.87, 19.81, 443.4, 2.4, 268.72, 8.86, 337.3, 234.01, 460.62, 23.94, 12.03, 169.69, 231.97, 325.68, 386.52, 28.45, 372.58, 11.53, 134.79, 3.58, 467.37, 363.16, 326.57, 3.04, 65.21, 121.82, 453.3, 422.57, 468.32, 469.03, 146.72, 401.51, 467.09, 9.44, 34.89, 29.38, 412.18, 413.2, 186.57, 446.06, 2.39, 90.84, 459.72, 390.18, 16.05, 448.55, 89.92, 261.9, 451.12, 59.03, 233.14, 1.87, 75.08, 2.9, 52.48, 5.78, 398.56, 3.96, 1.51, 302.77, 348.48, 2.93, 440.86, 180.59, 19.73, 7.29, 106.44, 5.25, 3.32, 7.48, 446.79, 234.82, 13.35, 13.08, 10.15, 279.56, 2.07, 244.53, 4.74, 14.84, 424.81, 37.82, 46.66, 438.82, 371.09, 373.12, 409.23, 129.88, 19.66, 356.25, 294.39, 456.77, 340.8, 57.35, 399.63, 300.39, 35.54, 198.75, 438.04, 352.51, 402.51, 6.53, 466.51, 24.42, 413.65, 21.46, 330.32, 97.52, 22.93, 366.95, 461.3, 466.38, 161.91, 271.84, 8.25, 4.03, 106.98, 460.42, 422.29, 382.97, 473.74, 242.06, 1.61, 45.37, 43.83, 346.35, 335.96, 241.73, 65.36, 447.56, 443.83, 72.0, 386.47, 2.03, 6.41, 6.2, 440.65, 128.53, 25.15, 131.67, 456.09, 472.66, 44.98, 411.75, 285.92, 77.42, 365.95, 273.27, 443.85, 270.54, 145.92, 308.28, 380.01, 34.31, 299.43, 369.28, 116.25, 103.79, 126.88, 466.64, 395.56, 3.77, 2.76, 455.05, 1.44, 2.73, 469.24, 462.37, 41.35, 13.92, 77.07, 141.03, 3.92, 470.75, 147.01, 26.42, 465.23, 7.56, 2.75, 44.92, 454.59, 13.32, 63.93, 239.41, 426.33, 209.02, 105.04, 469.08, 93.15, 51.84, 311.38, 431.11, 25.94, 3.46, 7.59, 4.58, 102.3, 11.04, 3.62, 13.62, 262.71, 2.33, 85.38, 434.23, 20.61, 43.63, 288.61, 326.56, 468.14, 426.71, 342.71, 199.04, 356.64, 458.64, 399.85, 131.68, 167.24, 355.94, 439.81, 4.66, 460.93, 449.93, 16.98, 8.84, 1.04, 1.61, 468.58, 411.54, 470.37, 4.43, 438.8, 1.0, 61.27, 115.96, 358.2, 116.48, 1.13, 398.16, 234.24, 433.14, 229.15, 473.95, 16.15, 2.91, 402.81, 9.15, 2.86, 199.13, 78.6, 107.16, 4.32, 226.97, 323.9, 1.14, 174.1, 384.0, 333.93, 142.81, 356.82, 351.96, 159.8, 22.08, 362.04, 2.75, 444.73, 356.24, 115.43, 24.38, 425.95, 33.72, 448.09, 367.47, 465.47, 32.43, 417.74, 315.1, 27.36, 470.87, 211.09, 110.32, 360.12, 192.12, 56.37, 333.13, 439.63, 74.3, 385.47, 454.49, 261.67, 67.51, 275.93, 318.37, 2.14, 17.7, 439.63, 182.56, 4.7, 175.61, 3.61, 243.71, 372.37, 3.21, 351.85, 232.42, 116.24, 400.02, 71.02, 8.02, 455.42, 124.41, 222.69, 197.02, 35.34, 403.36, 181.62, 410.61, 51.14, 455.42, 347.48, 468.17, 431.85, 425.69, 180.01, 373.45, 462.4, 422.09, 1.86, 9.49, 213.73, 366.87, 44.7, 471.71, 67.79, 7.18, 7.08, 357.74, 73.64, 396.08, 1.13, 440.05, 60.46, 306.3, 25.17, 405.69, 34.22, 428.26, 131.58, 460.36, 94.27, 209.01, 467.3, 11.98, 46.1, 1.47, 428.43, 152.05, 1.59, 10.02, 376.08, 172.36, 9.36, 396.04, 151.77, 337.09, 441.65, 212.66, 460.43, 1.89, 90.98, 423.49, 133.51, 428.79, 32.65, 242.85, 448.41, 301.46, 466.0, 170.77, 65.2, 410.67, 51.94, 439.44, 445.61, 179.42, 1.13, 104.74, 21.38, 2.08, 350.8, 396.33, 426.92, 66.36, 104.74, 441.48, 116.82, 448.57, 435.03, 33.92, 196.73, 37.34, 27.68, 80.02, 9.4, 3.71, 13.47, 16.91, 2.23, 457.92, 148.24, 42.17, 389.41, 7.25, 64.92, 429.38, 157.88, 206.13, 459.96, 306.89, 10.19, 341.84, 428.24, 394.57, 297.76, 6.26, 3.77, 296.68, 65.84, 203.04, 425.19, 457.46, 16.52, 397.77, 421.39, 393.59, 83.23, 141.7, 219.73, 257.48, 211.87, 179.33, 8.18, 8.45, 103.67, 465.45, 170.33, 82.11, 7.38, 461.68, 264.86, 9.82, 18.41, 169.42, 435.81, 420.74, 3.42, 376.92, 129.57, 155.83, 234.03, 107.49, 354.54, 73.72, 7.23, 426.43, 423.93, 74.66, 26.2, 270.6, 264.69, 27.51, 287.1, 339.75, 424.25, 302.06, 36.51, 229.55, 61.12, 467.1, 38.87, 74.55, 448.99, 457.6, 0.97, 330.74, 285.79, 22.72, 199.04, 460.11, 5.6, 270.37, 71.16, 408.09, 90.07, 444.08, 408.2, 36.26, 48.87, 39.03, 409.13, 77.85, 346.94, 27.36, 163.65, 212.36, 10.87, 166.05, 31.81, 240.71, 446.33, 374.18, 96.0, 105.02, 19.41, 461.65, 203.77, 331.11, 318.33, 343.32, 373.59, 367.87, 270.67, 4.94, 75.48, 311.89, 103.75, 282.69, 87.71, 8.9, 442.01, 365.07, 336.13, 307.27, 368.15, 448.73, 92.68, 5.65, 4.04, 453.55, 450.33, 34.55, 15.99, 426.47, 447.01, 4.79, 63.37, 467.82, 285.23, 155.37, 474.01, 448.01, 309.87, 317.42, 303.8, 146.6, 30.94, 146.32, 431.86, 20.92, 373.76, 0.99, 466.78, 447.62, 5.37, 467.63, 3.85, 116.03, 392.11, 174.93, 171.4, 80.38, 103.27, 3.44, 212.29, 290.63, 45.7, 52.64, 3.64, 11.97, 22.22, 58.25, 4.97, 117.96, 2.09, 300.92, 37.21, 298.3, 116.51, 5.47, 364.55, 418.64, 1.59, 468.14, 427.89, 74.26, 442.03, 150.79, 403.79, 457.57, 36.56, 455.55, 420.61, 457.24, 297.06, 268.1, 295.47, 5.95, 122.53, 5.27, 351.02, 390.56, 426.39, 15.54, 418.62, 331.08, 418.3, 469.1, 133.35, 287.68, 183.41, 468.68, 12.27, 20.66, 445.91, 25.89, 428.94, 466.3, 383.63, 256.83, 2.37, 272.34, 12.78, 292.01, 54.75, 161.05, 128.47, 372.45, 418.66, 453.68, 373.23, 371.54, 0.97, 452.0, 463.82, 0.92, 445.37, 460.62, 456.09, 420.26, 453.17, 446.34, 448.21, 302.47, 105.69, 3.11, 222.47, 467.05, 395.9, 444.34, 436.91, 393.86, 219.42, 79.36, 128.34, 469.24, 434.21, 237.2, 397.95, 3.45, 3.98, 25.9, 203.11, 338.06, 34.6, 456.84, 29.1, 383.92, 22.59, 5.29, 259.89, 461.3, 227.3, 358.96, 250.14, 89.37, 362.84, 422.35, 324.19, 465.09, 462.04, 427.65, 463.74, 446.8, 444.66, 472.91, 364.22, 3.53, 453.56, 278.81, 255.62, 66.15, 355.44, 429.5, 404.44, 459.13, 75.5, 445.4, 218.65, 347.59, 418.87, 340.27, 3.56, 342.9, 1.08, 260.22, 28.54, 184.35, 394.66, 222.38, 36.71, 461.47, 461.72, 37.85, 34.9, 435.07, 2.21, 445.59, 290.35, 5.54, 198.43, 11.01, 23.06, 434.96, 405.49, 377.02, 154.69, 296.61, 435.74, 2.81, 400.99, 324.75, 339.38, 130.01, 5.7, 446.69, 319.82, 277.1, 439.0, 430.51, 463.0, 397.23, 320.19, 40.43, 28.42, 25.71, 427.91, 103.73, 388.06, 89.88, 467.93, 128.39, 270.7, 403.2, 275.9, 14.74, 5.04, 8.24, 352.54, 20.3, 7.9, 422.49, 149.54, 326.27, 347.78, 302.02, 331.27, 75.61, 46.05, 271.61, 141.31, 455.39, 274.31, 468.34, 463.57, 2.0, 265.77, 29.71, 352.91, 5.2, 83.01, 30.59, 134.76, 5.01, 453.28, 320.57, 169.38, 167.22, 469.36, 437.87, 460.88, 430.73, 451.46, 16.7, 22.08, 348.12, 269.58, 281.15, 447.12, 42.94, 7.43, 53.05, 204.93, 226.32, 122.14, 305.86, 5.57, 436.58, 175.17, 95.91, 215.03, 197.73, 461.22, 370.9, 208.9, 3.33, 410.34, 245.95, 15.65, 427.86, 245.66, 411.36, 384.33, 402.53, 438.38, 343.33, 420.58, 5.65, 392.17, 3.46, 426.17, 451.57, 1.33, 453.71, 359.53, 214.97, 466.96, 11.83, 71.25, 437.57, 8.0, 437.41, 466.44, 373.52, 9.89, 384.65, 402.96, 7.86, 2.58, 154.45, 67.75, 407.34, 40.19, 41.74, 0.93, 370.86, 52.76, 38.85, 12.74, 467.12, 304.78, 437.1, 285.3, 400.34, 69.91, 180.66, 4.56, 105.44, 18.12, 417.24, 6.69, 107.12, 1.46, 258.07, 52.17, 93.95, 165.1, 26.36, 362.56, 63.08, 118.75, 461.57, 107.24, 285.8, 264.67, 241.42, 1.44, 442.71, 343.42]
# lin_med = np.median(sig_lin)

# # sig_rand = [293.25, 279.42, 1.72, 1.33, 243.96, 2.43, 6.64, 2.3, 1.42, 7.3, 23.51, 66.21, 390.58, 1.74, 1.41, 462.75, 1.49, 5.58, 372.82, 18.35, 19.6,
# #             64.88, 355.47, 9.35, 110.49, 419.44, 1.51, 4.92, 422.53, 434.39, 472.53, 410.64, 159.13, 8.94, 194.49, 64.42, 27.2, 14.97, 73.26, 144.82, 96.07, 74.53, 1.69,
# #             428.6, 293.45, 461.66, 42.84, 3.55, 29.86, 12.76, 111.93, 146.71, 5.75, 456.72, 416.73, 4.09, 377.96, 4.25, 3.98, 270.26, 259.16, 2.36, 18.66, 283.66, 50.46, 267.14, 383.52, 411.66, 157.94, 216.84, 129.84, 326.77, 4.1, 356.57, 8.48, 108.49, 22.58, 67.33, 26.84, 2.02, 1.6,
# #             4.38, 151.27, 454.8, 447.58, 459.4, 3.45, 114.9, 285.96, 470.19, 139.36, 13.49, 1.65, 85.53, 1.36, 393.65, 430.81, 250.38, 327.95, 469.9, 110.17, 91.03, 159.38, 102.06, 388.15, 69.14, 469.88, 472.81, 255.35, 182.86, 433.4, 286.98, 218.8, 157.6, 133.01, 339.69, 452.74, 2.66, 106.37, 128.04, 4.97, 197.61, 58.24, 2.63, 1.24, 0.99, 29.07, 5.41, 47.57, 38.38,
# #             380.55, 263.27, 455.97, 4.11, 2.41, 414.2, 306.02, 373.06, 18.78, 81.53, 389.11, 4.63, 397.95, 51.36, 334.62, 463.38, 371.32, 408.29, 96.97, 6.74, 286.0, 20.62, 423.19, 439.16, 382.18, 418.24, 1.53, 5.42, 1.15, 3.85, 20.4, 4.1, 3.45, 2.82, 0.94, 126.83, 142.13, 27.23, 15.11, 7.82, 322.71, 2.78, 1.13, 24.35, 367.02, 1.28, 14.43, 1.78]
# sig_rand = [1.14, 8.59, 450.14, 449.9, 9.36, 1.42, 22.35, 93.2, 3.15, 74.32, 32.11, 92.93, 98.8, 210.34, 123.48, 430.76, 409.65, 300.23, 220.59, 26.67, 1.1, 7.83, 441.44, 1.17, 22.34, 3.93, 110.59, 9.0, 297.81, 354.81, 422.53, 5.25, 28.87, 19.12, 15.66, 358.21, 460.57, 2.7, 1.87, 3.23, 3.9, 418.38, 456.1, 462.91, 114.17, 40.36, 9.74, 24.38, 1.08, 1.35, 45.98, 7.08, 1.28, 10.58, 1.48, 286.3, 299.4, 320.32, 462.08, 399.45, 53.75, 7.18, 3.61, 5.96, 3.33, 117.05, 435.52, 5.88, 395.47, 453.09, 3.73, 2.43, 2.09, 28.08, 2.12, 21.54, 36.66, 19.22, 20.44, 12.54, 2.36, 4.15, 174.53, 324.76, 429.59, 14.79, 135.14, 353.01, 41.69, 25.83, 1.18, 1.08, 48.08, 5.68, 3.92, 247.34, 425.74, 449.78, 5.76, 33.05, 17.78, 1.63, 228.94, 1.91, 8.44, 56.25, 37.43, 1.66, 54.03, 202.8, 59.83, 100.96, 357.52, 74.78, 314.53, 425.88, 434.88, 18.73, 33.65, 137.89, 2.2, 9.29, 12.43, 23.78, 3.33, 436.4, 11.09, 27.87, 85.73, 85.8, 10.31, 66.96, 452.62, 397.33, 64.78, 19.13, 195.33, 87.63, 3.32, 3.91, 7.09, 1.08, 49.12, 379.93, 442.3, 97.48, 7.12, 464.38, 8.19, 91.22, 74.13, 24.56, 89.35, 9.77, 12.36, 18.75, 24.96, 42.26, 24.6, 2.89, 42.08, 1.85, 336.53, 12.54, 15.25, 90.28, 55.05, 324.79, 1.37, 1.35, 2.62, 58.94, 327.5, 260.79, 283.59, 136.64, 235.95, 38.98, 5.61, 422.46, 229.74, 82.9, 2.06, 5.92, 1.73, 5.18, 78.32, 64.63, 49.33, 20.24, 64.92, 405.43, 49.31, 37.42, 2.12, 6.61, 27.51, 9.07, 2.62, 4.16, 2.69, 97.42, 102.95, 256.06, 428.74, 65.5, 1.51, 155.55, 416.01, 1.53, 49.32, 78.99, 14.36, 4.07, 9.17, 465.75, 315.59, 134.98, 2.69, 26.3, 1.65, 292.29, 4.57, 16.27, 39.75, 243.68, 245.41, 95.39, 464.05, 351.45, 41.46, 271.86, 9.17, 12.93, 11.45, 3.74, 6.19, 381.05, 10.42, 199.48, 1.12, 23.56, 66.27, 451.36, 2.69, 35.34, 346.32, 163.45, 18.63, 406.84, 432.99, 99.37, 459.97, 60.64, 61.05, 418.98, 180.79, 19.55, 47.44, 349.58, 27.73, 1.36, 59.96, 12.49, 108.6, 1.41, 465.84, 456.69, 73.68, 46.2, 1.47, 86.27, 2.96, 209.85, 3.04, 465.14, 1.04, 14.04, 20.3, 403.62, 433.7, 34.62, 47.34, 390.7, 45.93, 467.22, 197.92, 11.02, 9.22, 15.21, 1.06, 110.56, 13.91, 18.12, 466.96, 13.25, 335.76, 24.23, 80.18, 4.38, 3.02, 95.62, 25.71, 183.44, 14.99, 135.79, 99.44, 3.2, 4.27, 38.8, 2.63, 463.07, 168.98, 194.34, 461.44, 2.56, 379.24, 424.44, 465.5, 353.41, 181.67, 471.85, 39.5, 228.49, 314.2, 18.89, 389.9, 3.09, 415.55, 21.3, 14.13, 17.92, 43.87, 98.48, 3.33, 33.57, 188.08, 2.0, 11.28, 323.4, 4.15, 359.29, 396.68, 137.28, 175.45, 12.3, 51.64, 1.8, 465.33, 3.3, 140.41, 1.75, 67.76, 4.2, 22.49, 76.64, 470.71, 471.0, 8.42, 15.02, 17.08, 3.74, 52.0, 1.17, 11.47, 21.74, 28.68, 44.59, 267.1, 10.84, 19.64, 376.32, 60.58, 2.06, 16.78, 4.76, 173.67, 203.9, 29.84, 198.61, 9.31, 10.11, 43.71, 54.69, 3.8, 7.16, 141.69, 185.14, 6.51, 1.89, 151.57, 122.99, 2.14, 2.61, 380.22, 7.93, 346.68, 287.49, 11.25, 35.48, 257.96, 452.64, 324.53, 2.46, 454.8, 4.6, 3.92, 28.81, 18.51, 5.4, 55.45, 71.45, 368.35, 2.84, 467.46, 179.56, 50.33, 341.83, 268.25, 424.99, 68.14, 1.82, 43.31, 15.89, 2.47, 352.6, 287.41, 3.77, 91.26, 2.89, 431.89, 156.58, 70.89, 79.46, 4.91, 94.98, 146.31, 4.83, 8.07, 238.21, 398.02, 5.12, 2.66, 32.29, 389.27, 402.83, 6.52, 403.1, 43.61, 20.97, 4.45, 1.42, 22.92, 438.85, 7.12, 6.81, 185.24, 381.57, 443.36, 190.94, 413.07, 2.54, 418.27, 14.5, 16.04, 9.82, 20.72, 65.25, 12.96, 17.23, 1.59, 126.93, 431.95, 95.07, 35.41, 450.61, 451.16, 28.52, 399.65, 5.3, 1.46, 3.07, 379.23, 178.84, 321.57, 34.21, 224.81, 8.42, 99.25, 457.91, 443.74, 28.59, 2.38, 82.94, 232.62, 1.86, 3.63, 24.38, 257.25, 81.48, 135.28, 32.93, 1.73, 54.84, 28.71, 1.63, 60.35, 1.21, 8.99, 3.82, 3.96, 3.56, 1.58, 212.69, 1.21, 303.54, 3.32, 3.35, 296.58, 453.43, 340.55, 1.89, 358.41, 11.35, 35.99, 367.99, 385.54, 455.9, 29.64, 430.42, 56.8, 457.54, 452.41, 4.18, 3.83, 458.3, 288.4, 254.93, 459.21, 57.92, 347.25, 104.59, 44.61, 2.09, 1.31, 5.62, 35.23, 29.43, 104.75, 1.7, 457.35, 90.91, 7.39, 462.07, 8.79, 1.81, 7.9, 8.46, 5.41, 1.99, 16.97, 7.86, 13.78, 29.01, 43.31, 179.58, 43.98, 254.26, 3.51, 4.52, 2.92, 4.57, 30.33, 133.67, 44.34, 1.82, 59.0, 3.77, 190.63, 3.16, 455.0, 18.48, 87.0, 449.85, 1.73, 18.96, 424.21, 432.31, 312.19, 2.39, 300.14, 164.54, 464.5, 7.12, 405.8, 465.14, 1.35, 96.37, 148.58, 92.59, 429.16, 66.35, 195.24, 429.57, 9.68, 249.52, 446.27, 456.45, 1.0, 11.77, 246.57, 18.65, 427.71, 8.23, 21.29, 38.93, 1.29, 170.78, 195.96, 126.14, 449.16, 347.67, 68.95, 276.59, 221.6, 430.62, 282.11, 1.07, 3.28, 1.37, 6.88, 297.25, 395.16, 3.47, 378.25, 104.24, 355.1, 9.12, 193.17, 468.86, 25.74, 461.24, 7.98, 425.03, 118.32, 468.15, 310.7, 454.26, 60.77, 12.06, 299.59, 336.43, 244.21, 1.91, 186.59, 332.22, 168.79, 1.38, 124.65, 472.07, 2.76, 374.55, 420.21, 467.73, 37.91, 4.82, 78.11, 464.5, 471.17, 12.53, 40.68, 437.95, 41.57, 188.14, 212.27, 24.35, 11.18, 332.12, 2.82, 2.71, 112.29, 458.76, 7.14, 389.15, 214.8, 46.49, 68.55, 6.18, 298.59, 4.38, 10.38, 4.11, 18.84, 4.7, 33.94, 1.28, 5.81, 1.58, 428.65, 1.19, 1.75, 151.8, 8.91, 1.56, 2.35, 5.2, 5.56, 462.84, 395.33, 226.8, 1.03, 473.32, 133.52, 4.4, 8.53, 430.03, 12.8, 1.27, 35.88, 14.24, 3.87, 5.9, 0.95, 425.69, 2.7, 440.15, 293.09, 9.79, 12.84, 204.37, 10.45, 60.41, 435.51, 112.78, 422.96, 192.73, 311.38, 468.81, 62.34, 2.41, 15.01, 3.5, 1.31, 29.54, 470.43, 466.01, 13.47, 331.54, 258.99, 294.36, 451.34, 325.9, 7.98, 369.61, 140.88, 1.31, 446.49, 19.36, 152.25, 66.25, 3.45, 23.89, 95.63, 460.12, 14.67, 364.71, 349.98, 3.34, 207.62, 242.71, 402.35, 220.35, 286.69, 21.71, 24.92, 3.7, 28.27, 214.62, 119.64, 463.28, 33.99, 1.63, 1.28, 49.06, 6.37, 223.54, 13.98, 472.1, 30.83, 288.99, 184.31, 3.25, 460.47, 41.64, 31.25, 75.81, 16.76, 4.34, 84.93, 7.35, 445.23, 3.2, 0.96, 81.59, 3.0, 11.49, 1.69, 20.23, 298.31, 387.34, 42.8, 321.22, 91.69, 340.68, 1.51, 199.75, 385.85, 426.93, 133.32, 340.07, 28.48, 10.88, 149.44, 44.43, 10.43, 28.68, 7.64, 59.95, 230.82, 42.29, 70.39, 3.51, 4.54, 83.96, 1.56, 285.06, 5.01, 460.1, 454.95, 14.06, 183.98, 372.27, 111.66, 4.48, 60.89, 1.61, 415.64, 2.34, 10.85, 354.34, 2.55, 152.33, 419.73, 195.34, 28.27, 44.64, 1.23, 1.82, 76.52, 319.5, 6.45, 413.71, 111.85, 208.68, 381.16, 1.27, 91.36, 357.32, 382.13, 385.6, 6.22, 11.05, 8.47, 97.22, 60.68, 10.61, 2.56, 138.79, 1.37, 69.22, 403.44, 27.58, 397.48, 3.88, 12.46, 282.8, 118.29, 1.55, 98.28, 15.67, 315.04, 443.5, 35.77, 140.65, 238.97, 21.91, 46.82, 55.33, 11.65, 444.01, 60.47, 3.07, 139.61, 9.93, 144.29, 39.17, 18.16, 10.02, 268.01, 3.0, 179.32, 427.16, 422.76, 342.11, 10.04, 28.05, 106.39, 90.88, 1.13, 3.22, 8.19, 228.13, 2.01, 191.59, 145.49, 327.5, 21.38, 4.17, 29.78, 398.46, 395.36, 334.5, 52.82, 1.66, 469.45, 6.25, 5.29, 36.37, 8.04, 311.73, 343.39, 4.41, 2.59, 372.43, 19.92, 118.18, 1.11, 247.99, 448.58, 104.69, 294.89, 322.29, 2.0, 123.57, 1.1, 121.09, 240.28, 14.2, 466.49, 343.28, 328.11, 120.01, 452.4, 4.88, 342.18, 227.82, 98.68, 26.65, 27.54, 427.31, 2.04, 447.7, 365.55, 381.65, 1.94, 7.08, 5.71, 12.04, 2.03, 90.19, 1.14, 2.39, 2.58, 35.84, 1.11, 5.08, 157.21, 10.2, 251.85, 262.11, 459.01, 44.92, 330.05, 1.47, 354.09, 11.97, 9.32, 374.74, 19.12, 468.22, 460.55, 278.05, 127.66, 174.91, 14.64, 29.73, 3.04, 15.88, 2.36, 467.4, 354.63, 3.12, 414.82, 337.5, 397.92, 382.7, 1.25, 13.06, 1.02, 171.81, 460.67, 4.62, 323.9, 470.3, 6.69, 420.26, 14.69, 4.78, 169.0, 302.25, 2.02, 18.37, 177.71, 35.21, 1.53, 3.9, 262.33, 324.48, 87.39, 322.41, 117.09, 462.77, 206.31, 352.16, 378.23, 418.83, 1.45, 2.24, 260.56, 60.46, 103.55, 12.81, 178.57, 148.08, 3.8, 5.5, 4.77, 3.4, 246.19, 220.12, 161.72, 1.75, 468.43, 84.69, 107.8, 4.05, 387.57, 6.26, 105.35, 123.98, 442.08, 24.55, 442.08, 360.98, 464.5, 391.79, 1.44, 473.57, 330.27, 56.7, 100.08, 147.8, 384.19, 446.46, 466.95, 18.82, 408.2, 3.07, 27.85, 63.15, 331.83, 49.05, 60.38, 96.44, 429.38, 409.78, 167.15, 80.79, 7.08, 376.83, 2.77, 292.63, 19.33, 222.51, 245.06, 3.35, 3.16, 14.28, 412.59, 27.33, 117.82, 69.26, 14.26, 427.91, 464.34, 63.12, 454.72, 5.16, 93.63, 5.88, 464.98, 253.51, 34.35, 12.01, 9.59, 18.14, 260.28, 1.0, 46.03, 2.74, 350.79, 23.3, 360.69, 2.44, 59.95, 274.02, 326.19, 32.22, 38.95, 405.35, 1.85, 78.89, 375.94, 466.24, 469.68, 16.21, 4.65, 4.47, 381.55, 17.11, 1.48, 9.23, 1.43, 437.67, 84.07, 426.78, 64.69, 194.89, 61.63, 45.29, 45.68, 18.57, 4.27, 3.02, 5.72, 17.95, 457.89, 317.06, 429.76, 228.55, 72.95, 335.85, 1.21, 236.49, 81.77, 49.07, 344.37, 257.06, 367.44, 1.78, 325.87, 465.95, 422.43, 258.82, 335.37, 14.13, 1.92, 359.88, 409.43, 8.08, 37.84, 20.46, 1.88, 203.8, 231.23, 340.08, 97.3, 414.63, 30.2, 181.36, 12.67, 139.39, 10.12, 1.82, 2.61, 76.4, 10.18, 226.9, 5.74, 201.32, 8.9, 4.69, 18.75, 366.03, 151.56, 454.17, 311.92, 1.27, 7.98, 2.81, 5.99, 13.65, 118.06, 357.2, 443.63, 2.53, 23.39, 2.28, 468.84, 1.02, 120.71, 1.23, 454.09, 386.73, 100.42, 136.46, 16.09, 159.94, 1.12, 112.46, 266.37, 254.12, 43.64, 231.81, 182.66, 174.65, 4.09, 104.69, 412.0, 452.51, 194.63, 58.44, 369.99, 79.39, 157.88, 33.45, 5.04, 466.93, 10.52, 447.62, 3.49, 41.47, 1.25, 454.01, 105.13, 179.17, 4.35, 1.03, 1.51, 11.34, 342.53, 2.92, 24.93, 76.77, 312.78, 143.59, 234.38, 168.89, 1.67, 2.1, 7.22, 462.7, 129.37, 1.46, 69.63, 209.66, 67.1, 2.22, 23.23, 447.01, 31.04, 3.68, 10.06, 356.15, 5.25, 2.71, 18.92, 309.39, 1.38, 1.03, 322.42, 7.93, 397.36, 190.21, 15.42, 269.18, 91.4, 8.81, 71.18, 405.45, 169.1, 190.02, 16.1, 4.69, 44.26, 126.47, 10.75, 12.02, 73.37, 382.68, 470.77, 1.34, 187.66, 438.57, 1.32, 6.04, 87.22, 10.16, 65.6, 203.7, 96.17, 36.79, 126.74, 270.15, 417.35, 254.15, 281.37, 450.57, 195.89, 3.48, 447.07, 140.34, 26.36, 24.0, 1.06, 3.88, 347.89, 1.58, 30.85, 2.36, 411.79, 40.68, 8.48, 25.93, 7.83, 127.6, 253.48, 257.67, 401.58, 2.04, 244.12, 1.91, 324.07, 1.3, 19.95, 5.38, 285.53, 380.03, 5.87, 455.66, 447.48, 134.87, 19.27, 13.42, 1.26, 8.66, 416.81, 3.57, 296.68, 33.76, 10.59, 66.15, 452.04, 349.68, 98.17, 75.29, 20.27, 11.72, 1.43, 215.77, 460.1, 2.72, 1.37, 2.77, 7.02, 409.16, 18.32, 125.01, 468.75, 25.87, 381.79, 2.11, 175.12, 256.61, 1.48, 356.93, 21.74, 
# 145.86, 446.51, 307.37, 8.38, 1.36, 55.5, 6.57, 318.7, 79.22, 259.28, 102.27, 458.3, 61.2, 445.52, 31.51, 1.09, 250.01, 14.75, 1.13, 212.11, 152.37, 70.19, 229.79, 224.41, 84.6, 0.89, 183.55, 24.05, 2.34, 16.48, 9.73, 464.55, 1.6, 14.28, 55.23, 35.48, 435.51, 429.61, 11.7, 317.38, 445.32, 9.55, 133.1, 155.74, 440.38, 13.38, 464.27, 462.71, 450.74, 120.06, 74.65, 1.06, 470.65, 12.99, 5.34, 45.75, 329.29, 208.45, 5.93, 397.86, 368.74, 226.43, 85.42, 413.88, 1.66, 455.01, 271.02, 439.93, 375.89, 2.47, 32.33, 103.26, 444.12, 393.45, 129.26, 25.53, 39.27, 205.38, 61.75, 285.77, 177.53, 402.96, 6.78, 134.77, 4.38, 228.31, 418.51, 249.01, 228.49, 57.52, 248.48, 97.09, 148.65, 20.5, 29.7, 305.65, 16.03, 18.45, 29.06, 1.56, 432.02, 1.59, 46.38, 9.42, 83.23, 205.45, 270.08, 2.1, 60.61, 468.92, 14.97, 450.27, 219.9, 44.26, 178.31, 197.71, 287.26, 1.15, 11.62, 1.94, 2.68, 332.97, 7.05, 77.22, 20.66, 7.88, 50.67, 16.18, 2.36, 1.51, 10.37, 444.0, 3.29, 13.35, 11.88, 360.37, 459.31, 454.39, 13.39, 6.82, 3.19, 436.37, 69.62, 3.39, 470.28, 6.23, 465.52, 465.54, 454.9, 98.15, 267.23, 366.84, 298.4, 26.78, 1.35, 52.08, 91.31, 38.02, 219.16, 46.36, 418.04, 311.81, 138.54, 381.37, 441.88, 376.57, 158.02, 1.67, 0.96, 124.97, 240.67, 71.44, 359.74, 147.29, 20.68, 129.82, 12.75, 21.2, 7.29, 446.45, 72.52, 303.64, 474.72, 103.23, 24.57, 106.59, 10.65, 7.54, 8.3, 8.25, 94.93, 459.11, 5.67, 431.88, 289.1, 269.82, 8.64, 1.24, 2.36, 68.51, 476.13, 303.5, 129.35, 10.05, 46.64, 121.41, 402.07, 318.34, 406.91, 3.46, 2.81, 29.7, 4.5, 146.52, 436.41, 1.19, 1.13, 69.86, 25.04, 8.41, 7.84, 465.83, 22.67, 469.37, 45.68, 372.44, 157.3, 1.35, 434.74, 205.91, 156.85, 430.22, 437.99, 2.35, 331.79, 366.06, 275.89, 122.91, 369.56, 224.12, 419.54, 103.49, 144.31, 178.94, 122.57, 165.44, 25.71, 333.53, 3.19, 193.63, 191.81, 1.77, 2.14, 5.32, 270.68, 63.41, 7.89, 2.21, 227.31, 9.7, 7.58, 14.04, 6.35, 1.83, 3.36, 232.88, 444.77, 178.22, 88.14, 466.78, 86.96, 447.8, 425.67, 3.21, 53.16, 19.87, 382.95, 469.71, 16.05, 14.02, 1.27, 44.62, 65.93, 60.06, 346.2, 310.1, 60.56, 305.89, 375.89, 0.95, 33.51, 10.1, 4.29, 435.5, 7.86, 58.99, 430.13, 459.95, 41.83, 460.5, 7.5, 3.24, 111.63, 52.0, 250.51, 396.14, 24.73, 115.08, 1.35, 275.6, 2.05, 288.12, 311.83, 9.03, 396.43, 13.31, 198.54, 13.26, 2.08, 83.18, 1.87, 320.11, 9.62, 3.48, 2.67, 440.37, 381.65, 58.31, 1.83, 402.59, 360.92, 380.65, 314.77, 255.41, 98.69, 3.83, 453.17, 236.01, 458.89, 35.2, 13.67, 1.61, 352.2, 451.99, 192.87, 1.1, 471.29, 171.55, 8.23, 418.85, 6.08, 105.61, 465.25, 466.11, 4.28, 76.11, 29.74, 465.38, 1.25, 4.19, 216.32, 415.04, 403.8, 462.16, 70.97, 10.02, 223.27, 12.46, 227.45, 75.77, 2.71, 4.0, 1.24, 23.63, 210.78, 1.82, 47.65, 37.13, 1.3, 459.48, 11.76, 250.37, 46.92, 25.22, 419.29, 1.83, 13.64, 462.33, 11.33, 63.92, 1.08, 238.67, 7.18, 2.38, 470.53, 380.22, 325.52, 215.07, 326.2, 6.87, 190.36, 29.74, 444.05, 11.8, 25.61, 6.82, 1.95, 21.79, 8.53, 409.02, 88.01, 1.16, 48.65, 31.71, 41.81, 460.79, 7.03, 273.27, 437.88, 443.02, 425.77, 360.76, 118.0, 1.23, 310.72, 1.14, 3.51, 465.94, 4.07, 231.71, 475.37, 5.05, 470.52, 15.49, 34.89, 245.01, 2.49, 1.25, 470.37, 37.42, 355.13, 8.4, 53.18, 161.76, 428.46, 16.76, 11.69, 442.3, 224.84, 3.19, 185.3, 1.01, 113.67, 0.97, 129.87, 13.91, 9.29, 2.11, 468.75, 2.56, 60.37, 440.44, 55.39, 2.25, 138.94, 454.42, 3.56, 15.87, 20.44, 60.24, 4.35, 365.02, 23.84, 2.67, 183.59, 2.85, 16.47, 136.26, 142.19, 2.62, 42.82, 471.55, 12.75, 22.17, 455.13, 12.53, 1.56, 2.12, 3.33, 1.59, 404.17, 93.25, 397.16, 241.08, 80.72, 21.8, 160.0, 75.54, 413.26, 1.54, 11.09, 52.85, 1.05, 217.58, 4.83, 160.65, 1.21, 18.31, 51.68, 2.86, 226.38, 290.82, 6.44, 439.86, 1.79, 1.54, 11.56, 14.56, 25.99, 6.65, 4.96, 367.08, 307.81, 386.85, 18.15, 36.82, 1.54, 4.82, 5.98, 391.62, 70.64, 39.04, 3.82, 7.49, 29.43, 1.45, 0.9, 306.5, 388.18, 1.91, 468.37, 2.36, 136.45, 2.46, 268.0, 4.36, 376.31, 22.04, 2.96, 445.9, 342.52, 461.47, 235.65, 17.03, 6.07, 56.76, 18.69, 225.29, 3.66, 336.25, 413.79, 447.17, 16.69, 84.65, 7.6, 251.42, 15.36, 1.75, 3.26, 2.71, 4.77, 10.16, 13.2, 1.04, 300.64, 409.7, 9.77, 327.91, 215.05, 1.99, 6.12, 21.6, 160.08, 382.81, 5.6, 28.45, 5.73, 140.71, 3.9, 49.39, 251.43, 199.56, 2.94, 80.08, 32.76, 2.08, 401.33, 84.28, 467.66, 3.37, 1.56, 15.47, 423.01, 92.54, 24.51, 2.74, 1.32, 5.44, 2.64, 5.7, 1.29, 2.77, 3.11, 7.29, 65.35, 44.25, 3.22, 4.76, 6.88, 238.84, 272.06, 12.15, 19.0, 7.16, 12.06, 317.99, 3.5, 34.38, 1.46, 437.27, 435.83, 1.35, 2.33, 1.6, 2.36, 13.1, 12.9, 2.19, 2.1, 8.7, 3.39, 1.32, 5.93, 5.1, 3.22, 37.51, 25.67, 466.56, 464.23, 75.34, 3.01, 115.29, 133.8, 1.91, 438.75, 1.42, 44.03, 1.77, 52.35, 26.01, 253.94, 13.41, 36.02, 2.3, 2.06, 35.95, 95.23, 250.75, 7.07, 6.78, 65.22, 10.46, 2.29, 13.04, 16.02, 166.55, 38.3, 16.51, 29.78, 408.46, 1.8, 1.15, 124.5, 17.27, 73.92, 23.68, 2.68, 1.41]
# rand_med = np.median(sig_rand)

# SUBTREE ANALYSIS

no_sims = 50

gens = range(0,30)

def diffusion(p):

    # if p[1] == 'sigmoid':
    #     decoher = sig_sig
    #     decoher_med = sig_med
    # elif p[1] == 'linear':
    #     decoher = sig_lin
    #     decoher_med = lin_med
    # else:
    #     decoher = sig_rand
    #     decoher_med = rand_med

    ind_inits = np.logspace(np.log10(4.5),np.log10(450),9)
    # ind_inits = [450]
    ind_inits_strs = [re.sub('\.','_',str(round(h,2))) for h in ind_inits]  
    # ind_inits_success = []
    # ind_inits_success_kp = []

    # deco_times = []
    # deco_times_kp = []

    # ptr.figure(figsize=(10,10), dpi=100)

    # ax = ptr.subplot(211, title='Decoherence trajectories')
    # ax.set_ylabel("Similarity (median)")
    # ax.set_xlabel("Generations")

    # ax_2 = ptr.subplot(212)
    # ax_2.set_ylabel("Similarity (KP)")
    # ax_2.set_xlabel("Generations")

    for init in range(len(ind_inits)):
        v0 = ind_inits[init]
        v0_str = ind_inits_strs[init]

        trees = []

        data_whole = pd.DataFrame()
        r0s_inner = []
        for i in range(no_sims):
            # print("Sim: " + str(i))
            sim_no = i
            counter = 0
            while(True):
                model = InfectionMultiscaleModel(pop, steps_per_day=steps_per_day, v_threshold=10000, G=p[0], F=p[1], con_init=v0, sig_init=10, delay=0, lin_init=0.01, log_init=400)
                for i in range(steps):
                    model.step()
                    if model.infected == 0:
                        model.step()
                        break
                if model.removed > 10:
                    break
                counter += 1
                if counter == 100:
                    print('No result: ' + v0_str)
                    break

            data = get_column_data(model)
            tree = nx.DiGraph()

            print(p[1], sim_no, v0, max(data['Removed']))

            for i, row in data.iterrows():
                if not len(row['Viral Load Tree']) == 0:
                    for i in row['Viral Load Tree']:
                        if tree.number_of_nodes() < 10000:
                            if tree.has_node(i[0]):
                                tree.add_node(i[1], init_v=round(row['Viral Load Tree'][i][1],2), time=round(row['Viral Load Tree'][i][3],2), gen=tree.nodes[i[0]]['gen'] + 1)
                                tree.add_edge(i[0],i[1], rec_init=round(row['Viral Load Tree'][i][1],2))
                            else:
                                tree.add_node(i[0], init_v=round(row['Viral Load Tree'][i][0],2), time=0, gen=0)
                                tree.add_node(i[1], init_v=round(row['Viral Load Tree'][i][1],2), time=round(row['Viral Load Tree'][i][3],2), gen=tree.nodes[i[0]]['gen'] + 1)
                                tree.add_edge(i[0],i[1],rec_init=round(row['Viral Load Tree'][i][1],2)) 

            trees.append(tree)
            
            if i==0:
                data_whole = data
            else:
                data_whole = data_whole.append(data)

            if counter == 100:
                break
        
        data_whole.to_csv(p[0] + '_' + p[1] + '_' + v0_str + '.csv')

            
        # binned_time = []
        # bins_time = np.linspace(0,days,num=21)
        # for g in bins_time:
        #     binned_time.append([])

        # binned_gen = []
        # bins_gen = list(range(0,31,1))
        # for g in bins_gen:
        #     binned_gen.append([])

        # coh_bin_gen_med = []
        # coh_bin_gen_kp = []

        # deco_bin_gen_med = []
        # deco_bin_gen_kp = []

        # for g in bins_gen:
        #     coh_bin_gen_med.append([])
        #     coh_bin_gen_kp.append([])


        # for tree in trees:


        #     for node in tree.nodes():
        #         sub = nx.dfs_tree(tree,node)
        #         bin_no_time = np.digitize(tree.nodes[node]['time']/steps_per_day,bins_time)
        #         bin_no_gen = np.digitize(tree.nodes[node]['gen'],bins_gen)

        #         binned_time[bin_no_time].append(tree.nodes[node]['init_v'])
        #         if bin_no_gen < len(binned_gen):
        #             binned_gen[bin_no_gen].append(tree.nodes[node]['init_v'])

    #             deco_med = False
    #             deco_kp = False

    #             for bin_gen in range(len(binned_gen)):
                    
    #                 if binned_gen[bin_gen]:
    #                     med_gen = np.median(binned_gen[bin_gen])
    #                     med_diff = abs(med_gen - decoher_med)

    #                     coh_bin_gen_med[bin_gen].append(med_diff)

    #                     if not deco_med and med_diff < 20:
    #                         deco_bin_gen_med.append(bin_gen)
    #                         deco_med = True

    #                     kp_sim = ks_2samp(binned_gen[bin_gen],decoher)
    #                     kp_sim = kp_sim[1]

    #                     coh_bin_gen_kp[bin_gen].append(kp_sim)

    #                     if not deco_kp and kp_sim > 0.8:
    #                         deco_bin_gen_kp.append(bin_gen)
    #                         deco_kp = True

    #         coh_gen_mean = [np.mean(h) for h in coh_bin_gen_med if h]
    #         coh_gen_mean_kp = [np.mean(h) for h in coh_bin_gen_kp if h]

    #         ax.plot(gens[:len(coh_gen_mean)],coh_gen_mean, label=v0_str)
    #         ax_2.plot(gens[:len(coh_gen_mean_kp)],coh_gen_mean_kp, label=v0_str)

    #         if deco_bin_gen_med:
    #             deco_times.append(np.mean(deco_bin_gen_med))
    #             ind_inits_success.append(v0)
            
    #         if deco_bin_gen_kp:
    #             deco_times_kp.append(np.mean(deco_bin_gen_kp))
    #             ind_inits_success_kp.append(v0)
    
    
    # ax.legend()
    # ax_2.legend()

    # ptr.tight_layout()

    # ptr.savefig(fname='Decoherence_trajetories_' + str(p[0]) + '_' + str(p[1]))
    # # ptr.show()

    # ptr.close('all')

    # ptr.figure(figsize=(10,10), dpi=100)

    # ax = ptr.subplot(111, title='Decoherence times')
    # ax.set_ylabel("Generations")
    # ax.set_xlabel("Index case initial viral load")

    # print(ind_inits_success,deco_times)
    # ax.plot(ind_inits_success,deco_times, label='Median threshold')
    # ax.plot(ind_inits_success_kp,deco_times_kp, label='KP threshold')

    # ax.legend()

    # ptr.tight_layout()

    # ptr.savefig(fname='Decoherence_times_' + str(p[0]) + '_' + str(p[1]))
    # ptr.show()

    ptr.close('all')


with Pool(5) as p:
    p.map(diffusion,work)